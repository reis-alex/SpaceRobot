<!-- saved from url=(0014)about:internet -->
<html>
<body>
<script src="resources/eml_report_loadable_data.js"></script>
<pre class="code">
<span class="srcline"><span class="lineno"><a href="120,1" id="srcline1">  1</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T1U3">tau_ndi_qc</span>,<span class="var type1" id="S3T1U4">w</span>,<span class="var type1" id="S4T30U5">M_star</span>,<span class="var type1" id="S5T30U6">D_star</span>]= fcn(<span class="var type1" id="S6T1U9">w_ref</span>,<span class="var type1" id="S7T1U10">w_ref_int</span>,<span class="var type1" id="S8T5U11">w_int</span>,<span class="var type1" id="S9T3U12">r0</span>,<span class="var type1" id="S10T4U13">R0</span>,<span class="var type1" id="S11T1U14">um</span>,<span class="var type1" id="S12T1U15">qm</span>,<span class="var type1" id="S13T2U16">u0</span>,<span class="var type2" id="S14T104V6U17">robot_unc_pre</span>, <span class="var type2" id="S15T94V7U18">robot_unc_post</span>, <span class="var type1" id="S16T5U19">is_captured</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="120,2" id="srcline2">  2</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="120,3" id="srcline3">  3</a></span><span class="line">    <span class="comment">%-- Dimensions --%</span></span></span>
<span class="srcline"><span class="lineno"><a href="120,4" id="srcline4">  4</a></span><span class="line">    <span class="mxinfo " id="T5:U16"><span class="var type1" id="S17T5U22">dim_0</span> = <span class="mxinfo " id="T5:U18">6</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="120,5" id="srcline5">  5</a></span><span class="line">    <span class="mxinfo " id="T5:U19"><span class="var type1" id="S18T5U26">dim_q</span> = <span class="mxinfo " id="T5:U21"><span class="var type1" id="S14T104U28">robot_unc_pre</span>.n_q</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="120,6" id="srcline6">  6</a></span><span class="line">    <span class="mxinfo " id="T5:U23"><span class="var type1" id="S19T5U32">dim_r</span> = <span class="mxinfo " id="T5:U25"><span class="mxinfo " id="T18:U26"><span class="var type1" id="S14T104U35">robot_unc_pre</span>.dimensions</span>.dim_r</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="120,7" id="srcline7">  7</a></span><span class="line">    <span class="mxinfo " id="T5:U28"><span class="var type1" id="S20T5U40">dim_m</span> = <span class="mxinfo " id="T5:U30"><span class="mxinfo " id="T18:U31"><span class="var type1" id="S14T104U43">robot_unc_pre</span>.dimensions</span>.dim_m</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="120,8" id="srcline8">  8</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="120,9" id="srcline9">  9</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="120,10" id="srcline10"> 10</a></span><span class="line">    <span class="keyword">if</span> <span class="var type1" id="S16T5U48">is_captured</span> </span></span>
<span class="srcline"><span class="lineno"><a href="120,11" id="srcline11"> 11</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="120,12" id="srcline12"> 12</a></span><span class="line">         <span class="comment">%--- Kinematics ---%</span></span></span>
<span class="srcline"><span class="lineno"><a href="120,13" id="srcline13"> 13</a></span><span class="line">        <span class="comment">%Kinematics</span></span></span>
<span class="srcline"><span class="lineno"><a href="120,14" id="srcline14"> 14</a></span><span class="line">        [<span class="mxinfo " id="T98:U34">~</span>,<span class="var type1" id="S21T98U53">RL</span>,<span class="var type1" id="S22T99U54">rJ</span>,<span class="var type1" id="S23T99U55">rL</span>,<span class="var type1" id="S24T99U56">e</span>,<span class="var type1" id="S25T99U57">g</span>]    =   <span class="fcn" id="F337N14:B59">Kinematics</span>(<span class="var type1" id="S10T4U60">R0</span>,<span class="var type1" id="S9T3U61">r0</span>,<span class="var type1" id="S12T1U62">qm</span>,<span class="var type1" id="S15T94U63">robot_unc_post</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="120,15" id="srcline15"> 15</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="120,16" id="srcline16"> 16</a></span><span class="line">        <span class="comment">%Diferential Kinematics</span></span></span>
<span class="srcline"><span class="lineno"><a href="120,17" id="srcline17"> 17</a></span><span class="line">        [<span class="var type1" id="S27T100U67">Bij</span>,<span class="var type1" id="S28T101U68">Bi0</span>,<span class="var type1" id="S29T27U69">P0</span>,<span class="var type1" id="S30T33U70">pm</span>]     =   <span class="fcn" id="F338N5:B72">DiffKinematics</span>(<span class="var type1" id="S10T4U73">R0</span>,<span class="var type1" id="S9T3U74">r0</span>,<span class="var type1" id="S23T99U75">rL</span>,<span class="var type1" id="S24T99U76">e</span>,<span class="var type1" id="S25T99U77">g</span>,<span class="var type1" id="S15T94U78">robot_unc_post</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="120,18" id="srcline18"> 18</a></span><span class="line">        <span class="comment">%Velocities</span></span></span>
<span class="srcline"><span class="lineno"><a href="120,19" id="srcline19"> 19</a></span><span class="line">        [<span class="var type1" id="S32T2U82">t0</span>,<span class="var type1" id="S33T33U83">tL</span>]             =   <span class="fcn" id="F339N19:B85">Velocities</span>(<span class="var type1" id="S27T100U86">Bij</span>,<span class="var type1" id="S28T101U87">Bi0</span>,<span class="var type1" id="S29T27U88">P0</span>,<span class="var type1" id="S30T33U89">pm</span>,<span class="var type1" id="S13T2U90">u0</span>,<span class="var type1" id="S11T1U91">um</span>,<span class="var type1" id="S15T94U92">robot_unc_post</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="120,20" id="srcline20"> 20</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="120,21" id="srcline21"> 21</a></span><span class="line">        <span class="comment">%--- Dynamics ---%</span></span></span>
<span class="srcline"><span class="lineno"><a href="120,22" id="srcline22"> 22</a></span><span class="line">        <span class="comment">%Inertias in inertial frames</span></span></span>
<span class="srcline"><span class="lineno"><a href="120,23" id="srcline23"> 23</a></span><span class="line">        [<span class="var type1" id="S35T4U96">I0</span>,<span class="var type1" id="S36T98U97">Im</span>]             =   <span class="fcn" id="F340N10:B99">I_I</span>(<span class="var type1" id="S10T4U100">R0</span>,<span class="var type1" id="S21T98U101">RL</span>,<span class="var type1" id="S15T94U102">robot_unc_post</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="120,24" id="srcline24"> 24</a></span><span class="line">        <span class="comment">%Mass Composite Body matrix</span></span></span>
<span class="srcline"><span class="lineno"><a href="120,25" id="srcline25"> 25</a></span><span class="line">        [<span class="var type1" id="S38T27U106">M0_tilde</span>,<span class="var type1" id="S39T101U107">Mm_tilde</span>] =   <span class="fcn" id="F341N15:B109">MCB</span>(<span class="var type1" id="S35T4U110">I0</span>,<span class="var type1" id="S36T98U111">Im</span>,<span class="var type1" id="S27T100U112">Bij</span>,<span class="var type1" id="S28T101U113">Bi0</span>,<span class="var type1" id="S15T94U114">robot_unc_post</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="120,26" id="srcline26"> 26</a></span><span class="line">        <span class="comment">%Generalized Inertia matrix</span></span></span>
<span class="srcline"><span class="lineno"><a href="120,27" id="srcline27"> 27</a></span><span class="line">        [<span class="var type1" id="S41T27U118">H0</span>,<span class="var type1" id="S42T29U119">H0q</span>,<span class="var type1" id="S43T30U120">Hq</span>]         =   <span class="fcn" id="F342N7:B122">GIM</span>(<span class="var type1" id="S38T27U123">M0_tilde</span>,<span class="var type1" id="S39T101U124">Mm_tilde</span>,<span class="var type1" id="S27T100U125">Bij</span>,<span class="var type1" id="S28T101U126">Bi0</span>,<span class="var type1" id="S29T27U127">P0</span>,<span class="var type1" id="S30T33U128">pm</span>,<span class="var type1" id="S15T94U129">robot_unc_post</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="120,28" id="srcline28"> 28</a></span><span class="line">        <span class="comment">%Generalized Convective Inertia matrix</span></span></span>
<span class="srcline"><span class="lineno"><a href="120,29" id="srcline29"> 29</a></span><span class="line">        [<span class="var type1" id="S45T27U133">C0</span>, <span class="var type1" id="S46T29U134">C0q</span>, <span class="var type1" id="S47T31U135">Cq0</span>, <span class="var type1" id="S48T30U136">Cq</span>]  =   <span class="fcn" id="F343N2:B138">CIM</span>(<span class="var type1" id="S32T2U139">t0</span>,<span class="var type1" id="S33T33U140">tL</span>,<span class="var type1" id="S35T4U141">I0</span>,<span class="var type1" id="S36T98U142">Im</span>,<span class="var type1" id="S38T27U143">M0_tilde</span>,<span class="var type1" id="S39T101U144">Mm_tilde</span>,<span class="var type1" id="S27T100U145">Bij</span>,<span class="var type1" id="S28T101U146">Bi0</span>,<span class="var type1" id="S29T27U147">P0</span>,<span class="var type1" id="S30T33U148">pm</span>,<span class="var type1" id="S15T94U149">robot_unc_post</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="120,30" id="srcline30"> 30</a></span><span class="line">        <span class="mxinfo " id="T2:U100"><span class="var type1" id="S50T2U152">u_EE</span> = <span class="mxinfo " id="T2:U102"><span class="var type1" id="S33T33U154">tL</span>(<span class="mxinfo " id="T35:U104">:</span>,<span class="mxinfo " id="T37:U105"><span class="var type1" id="S15T94U157">robot_unc_post</span>.id_EE</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="120,31" id="srcline31"> 31</a></span><span class="line">        <span class="mxinfo " id="T32:U107"><span class="var type1" id="S51T32U161">Mm</span> =<span class="mxinfo " id="T32:U109">[<span class="mxinfo " id="T33:U110"><span class="var type1" id="S41T27U164">H0</span> <span class="var type1" id="S42T29U165">H0q</span></span> ;<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="120,32" id="srcline32"> 32</a></span><span class="line">            <span class="mxinfo " id="T34:U113"><span class="mxinfo " id="T31:U114"><span class="var type1" id="S42T29U168">H0q</span>'</span> <span class="var type1" id="S43T30U169">Hq</span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="120,33" id="srcline33"> 33</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="120,34" id="srcline34"> 34</a></span><span class="line">        <span class="mxinfo " id="T32:U117"><span class="var type1" id="S52T32U172">Dm</span> =<span class="mxinfo " id="T32:U119">[<span class="mxinfo " id="T33:U120"><span class="var type1" id="S45T27U175">C0</span> <span class="var type1" id="S46T29U176">C0q</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="120,35" id="srcline35"> 35</a></span><span class="line">            <span class="mxinfo " id="T34:U123"><span class="var type1" id="S47T31U178">Cq0</span> <span class="var type1" id="S48T30U179">Cq</span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="120,36" id="srcline36"> 36</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="120,37" id="srcline37"> 37</a></span><span class="line">        [<span class="var type1" id="S53T27U183">J0EE</span>, <span class="var type1" id="S54T29U184">JmEE</span>]        =   <span class="fcn" id="F344N12:B186">Jacob</span>(<span class="mxinfo " id="T3:U128"><span class="var type1" id="S23T99U188">rL</span>(<span class="mxinfo " id="T36:U130">:</span>,<span class="mxinfo " id="T37:U131"><span class="var type1" id="S15T94U191">robot_unc_post</span>.id_EE</span>)</span>,<span class="var type1" id="S9T3U193">r0</span>,<span class="var type1" id="S23T99U194">rL</span>,<span class="var type1" id="S29T27U195">P0</span>,<span class="var type1" id="S30T33U196">pm</span>,<span class="var type1" id="S15T94U198">robot_unc_post</span>.id_EE,<span class="var type1" id="S15T94U200">robot_unc_post</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="120,38" id="srcline38"> 38</a></span><span class="line">        [<span class="var type1" id="S56T27U204">J0EEdot</span>, <span class="var type1" id="S57T29U205">JmEEdot</span>]  =   <span class="fcn" id="F345N13:B207">Jacobdot</span>(<span class="mxinfo " id="T3:U141"><span class="var type1" id="S23T99U209">rL</span>(<span class="mxinfo " id="T36:U143">:</span>,<span class="mxinfo " id="T37:U144"><span class="var type1" id="S15T94U212">robot_unc_post</span>.id_EE</span>)</span>,<span class="var type1" id="S50T2U214">u_EE</span>,<span class="var type1" id="S9T3U215">r0</span>,<span class="var type1" id="S13T2U216">u0</span>,<span class="var type1" id="S23T99U217">rL</span>,<span class="var type1" id="S33T33U218">tL</span>,<span class="var type1" id="S29T27U219">P0</span>,<span class="var type1" id="S30T33U220">pm</span>,<span class="var type1" id="S15T94U222">robot_unc_post</span>.id_EE,<span class="var type1" id="S15T94U224">robot_unc_post</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="120,39" id="srcline39"> 39</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="120,40" id="srcline40"> 40</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="120,41" id="srcline41"> 41</a></span><span class="line">        [<span class="var type1" id="S59T4U228">I0_dot</span>,<span class="var type1" id="S60T98U229">I_Idot</span>] = <span class="fcn" id="F346N11:B231">I_I_dot</span>(<span class="var type1" id="S10T4U232">R0</span>, <span class="var type1" id="S32T2U233">t0</span>, <span class="var type1" id="S21T98U234">RL</span>,<span class="var type1" id="S33T33U235">tL</span>,<span class="var type1" id="S15T94U236">robot_unc_post</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="120,42" id="srcline42"> 42</a></span><span class="line">        <span class="mxinfo " id="T106:U162">[<span class="var type1" id="S62T106U240">N</span>] = <span class="mxinfo " id="T106:U164"><span class="fcn" id="F347N16:B242">NOC</span>(<span class="var type1" id="S9T3U243">r0</span>,<span class="var type1" id="S23T99U244">rL</span>,<span class="var type1" id="S29T27U245">P0</span>,<span class="var type1" id="S30T33U246">pm</span>,<span class="var type1" id="S15T94U247">robot_unc_post</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="120,43" id="srcline43"> 43</a></span><span class="line">        <span class="mxinfo " id="T106:U170">[<span class="var type1" id="S64T106U251">Ndot</span>] = <span class="mxinfo " id="T106:U172"><span class="fcn" id="F349N17:B253">NOCdot</span>(<span class="var type1" id="S9T3U254">r0</span>,<span class="var type1" id="S32T2U255">t0</span>,<span class="var type1" id="S23T99U256">rL</span>,<span class="var type1" id="S33T33U257">tL</span>,<span class="var type1" id="S29T27U258">P0</span>,<span class="var type1" id="S30T33U259">pm</span>,<span class="var type1" id="S15T94U260">robot_unc_post</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="120,44" id="srcline44"> 44</a></span><span class="line">        [<span class="var type1" id="S66T27U264">H0_dot</span>, <span class="var type1" id="S67T29U265">H0q_dot</span>, <span class="var type1" id="S68T30U266">Hq_dot</span>]=<span class="fcn" id="F351N9:B268">GIM_NOCdot_parsed</span>(<span class="var type1" id="S62T106U269">N</span>, <span class="var type1" id="S64T106U270">Ndot</span>,<span class="var type1" id="S35T4U271">I0</span>,<span class="var type1" id="S36T98U272">Im</span>,<span class="var type1" id="S59T4U273">I0_dot</span>,<span class="var type1" id="S60T98U274">I_Idot</span>,<span class="var type1" id="S15T94U275">robot_unc_post</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="120,45" id="srcline45"> 45</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="120,46" id="srcline46"> 46</a></span><span class="line">        <span class="comment">% [H0_dot, H0q_dot, Hq_dot ] = H_dot_Lagrange(Im,Bi0,P0,R0,pm,r0,t0,rL,tL,RL,robot_unc_post);</span></span></span>
<span class="srcline"><span class="lineno"><a href="120,47" id="srcline47"> 47</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="120,48" id="srcline48"> 48</a></span><span class="line">    <span class="keyword">else</span> </span></span>
<span class="srcline"><span class="lineno"><a href="120,49" id="srcline49"> 49</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="120,50" id="srcline50"> 50</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="120,51" id="srcline51"> 51</a></span><span class="line">        <span class="comment">%--- Kinematics ---%</span></span></span>
<span class="srcline"><span class="lineno"><a href="120,52" id="srcline52"> 52</a></span><span class="line">        <span class="comment">%Kinematics</span></span></span>
<span class="srcline"><span class="lineno"><a href="120,53" id="srcline53"> 53</a></span><span class="line">        [<span class="mxinfo " id="T23:U190">~</span>,<span class="var type1" id="S21T23U281">RL</span>,<span class="var type1" id="S22T24U282">rJ</span>,<span class="var type1" id="S23T24U283">rL</span>,<span class="var type1" id="S24T24U284">e</span>,<span class="var type1" id="S25T24U285">g</span>]    =   <span class="fcn" id="F362N14:B287">Kinematics</span>(<span class="var type1" id="S10T4U288">R0</span>,<span class="var type1" id="S9T3U289">r0</span>,<span class="var type1" id="S12T1U290">qm</span>,<span class="var type1" id="S14T104U291">robot_unc_pre</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="120,54" id="srcline54"> 54</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="120,55" id="srcline55"> 55</a></span><span class="line">        <span class="comment">%Diferential Kinematics</span></span></span>
<span class="srcline"><span class="lineno"><a href="120,56" id="srcline56"> 56</a></span><span class="line">        [<span class="var type1" id="S27T25U295">Bij</span>,<span class="var type1" id="S28T26U296">Bi0</span>,<span class="var type1" id="S29T27U297">P0</span>,<span class="var type1" id="S30T28U298">pm</span>]     =   <span class="fcn" id="F363N5:B300">DiffKinematics</span>(<span class="var type1" id="S10T4U301">R0</span>,<span class="var type1" id="S9T3U302">r0</span>,<span class="var type1" id="S23T24U303">rL</span>,<span class="var type1" id="S24T24U304">e</span>,<span class="var type1" id="S25T24U305">g</span>,<span class="var type1" id="S14T104U306">robot_unc_pre</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="120,57" id="srcline57"> 57</a></span><span class="line">        <span class="comment">%Velocities</span></span></span>
<span class="srcline"><span class="lineno"><a href="120,58" id="srcline58"> 58</a></span><span class="line">        [<span class="var type1" id="S32T2U310">t0</span>,<span class="var type1" id="S33T28U311">tL</span>]             =   <span class="fcn" id="F364N19:B313">Velocities</span>(<span class="var type1" id="S27T25U314">Bij</span>,<span class="var type1" id="S28T26U315">Bi0</span>,<span class="var type1" id="S29T27U316">P0</span>,<span class="var type1" id="S30T28U317">pm</span>,<span class="var type1" id="S13T2U318">u0</span>,<span class="var type1" id="S11T1U319">um</span>,<span class="var type1" id="S14T104U320">robot_unc_pre</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="120,59" id="srcline59"> 59</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="120,60" id="srcline60"> 60</a></span><span class="line">        <span class="comment">%--- Dynamics ---%</span></span></span>
<span class="srcline"><span class="lineno"><a href="120,61" id="srcline61"> 61</a></span><span class="line">        <span class="comment">%Inertias in inertial frames</span></span></span>
<span class="srcline"><span class="lineno"><a href="120,62" id="srcline62"> 62</a></span><span class="line">        [<span class="var type1" id="S35T4U324">I0</span>,<span class="var type1" id="S36T23U325">Im</span>]             =   <span class="fcn" id="F365N10:B327">I_I</span>(<span class="var type1" id="S10T4U328">R0</span>,<span class="var type1" id="S21T23U329">RL</span>,<span class="var type1" id="S14T104U330">robot_unc_pre</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="120,63" id="srcline63"> 63</a></span><span class="line">        <span class="comment">%Mass Composite Body matrix</span></span></span>
<span class="srcline"><span class="lineno"><a href="120,64" id="srcline64"> 64</a></span><span class="line">        [<span class="var type1" id="S38T27U334">M0_tilde</span>,<span class="var type1" id="S39T26U335">Mm_tilde</span>] =   <span class="fcn" id="F366N15:B337">MCB</span>(<span class="var type1" id="S35T4U338">I0</span>,<span class="var type1" id="S36T23U339">Im</span>,<span class="var type1" id="S27T25U340">Bij</span>,<span class="var type1" id="S28T26U341">Bi0</span>,<span class="var type1" id="S14T104U342">robot_unc_pre</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="120,65" id="srcline65"> 65</a></span><span class="line">        <span class="comment">%Generalized Inertia matrix</span></span></span>
<span class="srcline"><span class="lineno"><a href="120,66" id="srcline66"> 66</a></span><span class="line">        [<span class="var type1" id="S41T27U346">H0</span>,<span class="var type1" id="S42T29U347">H0q</span>,<span class="var type1" id="S43T30U348">Hq</span>]         =   <span class="fcn" id="F367N7:B350">GIM</span>(<span class="var type1" id="S38T27U351">M0_tilde</span>,<span class="var type1" id="S39T26U352">Mm_tilde</span>,<span class="var type1" id="S27T25U353">Bij</span>,<span class="var type1" id="S28T26U354">Bi0</span>,<span class="var type1" id="S29T27U355">P0</span>,<span class="var type1" id="S30T28U356">pm</span>,<span class="var type1" id="S14T104U357">robot_unc_pre</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="120,67" id="srcline67"> 67</a></span><span class="line">        <span class="comment">%Generalized Convective Inertia matrix</span></span></span>
<span class="srcline"><span class="lineno"><a href="120,68" id="srcline68"> 68</a></span><span class="line">        [<span class="var type1" id="S45T27U361">C0</span>, <span class="var type1" id="S46T29U362">C0q</span>, <span class="var type1" id="S47T31U363">Cq0</span>, <span class="var type1" id="S48T30U364">Cq</span>]  =   <span class="fcn" id="F368N2:B366">CIM</span>(<span class="var type1" id="S32T2U367">t0</span>,<span class="var type1" id="S33T28U368">tL</span>,<span class="var type1" id="S35T4U369">I0</span>,<span class="var type1" id="S36T23U370">Im</span>,<span class="var type1" id="S38T27U371">M0_tilde</span>,<span class="var type1" id="S39T26U372">Mm_tilde</span>,<span class="var type1" id="S27T25U373">Bij</span>,<span class="var type1" id="S28T26U374">Bi0</span>,<span class="var type1" id="S29T27U375">P0</span>,<span class="var type1" id="S30T28U376">pm</span>,<span class="var type1" id="S14T104U377">robot_unc_pre</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="120,69" id="srcline69"> 69</a></span><span class="line">        <span class="mxinfo " id="T2:U256"><span class="var type1" id="S50T2U380">u_EE</span> = <span class="mxinfo " id="T2:U258"><span class="var type1" id="S33T28U382">tL</span>(<span class="mxinfo " id="T35:U260">:</span>,<span class="mxinfo " id="T37:U261"><span class="var type1" id="S14T104U385">robot_unc_pre</span>.id_EE</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="120,70" id="srcline70"> 70</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="120,71" id="srcline71"> 71</a></span><span class="line">        <span class="mxinfo " id="T32:U263"><span class="var type1" id="S51T32U389">Mm</span> =<span class="mxinfo " id="T32:U265">[<span class="mxinfo " id="T33:U266"><span class="var type1" id="S41T27U392">H0</span> <span class="var type1" id="S42T29U393">H0q</span></span> ;<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="120,72" id="srcline72"> 72</a></span><span class="line">            <span class="mxinfo " id="T34:U269"><span class="mxinfo " id="T31:U270"><span class="var type1" id="S42T29U396">H0q</span>'</span> <span class="var type1" id="S43T30U397">Hq</span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="120,73" id="srcline73"> 73</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="120,74" id="srcline74"> 74</a></span><span class="line">        <span class="mxinfo " id="T32:U273"><span class="var type1" id="S52T32U400">Dm</span> =<span class="mxinfo " id="T32:U275">[<span class="mxinfo " id="T33:U276"><span class="var type1" id="S45T27U403">C0</span> <span class="var type1" id="S46T29U404">C0q</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="120,75" id="srcline75"> 75</a></span><span class="line">            <span class="mxinfo " id="T34:U279"><span class="var type1" id="S47T31U406">Cq0</span> <span class="var type1" id="S48T30U407">Cq</span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="120,76" id="srcline76"> 76</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="120,77" id="srcline77"> 77</a></span><span class="line">        [<span class="var type1" id="S53T27U411">J0EE</span>, <span class="var type1" id="S54T29U412">JmEE</span>]      =   <span class="fcn" id="F369N12:B414">Jacob</span>(<span class="mxinfo " id="T3:U284"><span class="var type1" id="S23T24U416">rL</span>(<span class="mxinfo " id="T36:U286">:</span>,<span class="mxinfo " id="T37:U287"><span class="var type1" id="S14T104U419">robot_unc_pre</span>.id_EE</span>)</span>,<span class="var type1" id="S9T3U421">r0</span>,<span class="var type1" id="S23T24U422">rL</span>,<span class="var type1" id="S29T27U423">P0</span>,<span class="var type1" id="S30T28U424">pm</span>,<span class="var type1" id="S14T104U426">robot_unc_pre</span>.id_EE,<span class="var type1" id="S14T104U428">robot_unc_pre</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="120,78" id="srcline78"> 78</a></span><span class="line">        [<span class="var type1" id="S56T27U432">J0EEdot</span>, <span class="var type1" id="S57T29U433">JmEEdot</span>]  =   <span class="fcn" id="F370N13:B435">Jacobdot</span>(<span class="mxinfo " id="T3:U297"><span class="var type1" id="S23T24U437">rL</span>(<span class="mxinfo " id="T36:U299">:</span>,<span class="mxinfo " id="T37:U300"><span class="var type1" id="S14T104U440">robot_unc_pre</span>.id_EE</span>)</span>,<span class="var type1" id="S50T2U442">u_EE</span>,<span class="var type1" id="S9T3U443">r0</span>,<span class="var type1" id="S13T2U444">u0</span>,<span class="var type1" id="S23T24U445">rL</span>,<span class="var type1" id="S33T28U446">tL</span>,<span class="var type1" id="S29T27U447">P0</span>,<span class="var type1" id="S30T28U448">pm</span>,<span class="var type1" id="S14T104U450">robot_unc_pre</span>.id_EE,<span class="var type1" id="S14T104U452">robot_unc_pre</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="120,79" id="srcline79"> 79</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="120,80" id="srcline80"> 80</a></span><span class="line">        [<span class="var type1" id="S59T4U456">I0_dot</span>,<span class="var type1" id="S60T23U457">I_Idot</span>] = <span class="fcn" id="F371N11:B459">I_I_dot</span>(<span class="var type1" id="S10T4U460">R0</span>, <span class="var type1" id="S32T2U461">t0</span>, <span class="var type1" id="S21T23U462">RL</span>,<span class="var type1" id="S33T28U463">tL</span>,<span class="var type1" id="S14T104U464">robot_unc_pre</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="120,81" id="srcline81"> 81</a></span><span class="line">        <span class="mxinfo " id="T107:U318">[<span class="var type1" id="S62T107U468">N</span>] = <span class="mxinfo " id="T107:U320"><span class="fcn" id="F372N16:B470">NOC</span>(<span class="var type1" id="S9T3U471">r0</span>,<span class="var type1" id="S23T24U472">rL</span>,<span class="var type1" id="S29T27U473">P0</span>,<span class="var type1" id="S30T28U474">pm</span>,<span class="var type1" id="S14T104U475">robot_unc_pre</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="120,82" id="srcline82"> 82</a></span><span class="line">        <span class="mxinfo " id="T107:U326">[<span class="var type1" id="S64T107U479">Ndot</span>] = <span class="mxinfo " id="T107:U328"><span class="fcn" id="F374N17:B481">NOCdot</span>(<span class="var type1" id="S9T3U482">r0</span>,<span class="var type1" id="S32T2U483">t0</span>,<span class="var type1" id="S23T24U484">rL</span>,<span class="var type1" id="S33T28U485">tL</span>,<span class="var type1" id="S29T27U486">P0</span>,<span class="var type1" id="S30T28U487">pm</span>,<span class="var type1" id="S14T104U488">robot_unc_pre</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="120,83" id="srcline83"> 83</a></span><span class="line">        [<span class="var type1" id="S66T27U492">H0_dot</span>, <span class="var type1" id="S67T29U493">H0q_dot</span>, <span class="var type1" id="S68T30U494">Hq_dot</span>]=<span class="fcn" id="F376N9:B496">GIM_NOCdot_parsed</span>(<span class="var type1" id="S62T107U497">N</span>, <span class="var type1" id="S64T107U498">Ndot</span>,<span class="var type1" id="S35T4U499">I0</span>,<span class="var type1" id="S36T23U500">Im</span>,<span class="var type1" id="S59T4U501">I0_dot</span>,<span class="var type1" id="S60T23U502">I_Idot</span>,<span class="var type1" id="S14T104U503">robot_unc_pre</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="120,84" id="srcline84"> 84</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="120,85" id="srcline85"> 85</a></span><span class="line">        <span class="comment">% [H0_dot, H0q_dot, Hq_dot ] = H_dot_Lagrange(Im,Bi0,P0,R0,pm,r0,t0,rL,tL,RL,robot_unc_pre);</span></span></span>
<span class="srcline"><span class="lineno"><a href="120,86" id="srcline86"> 86</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="120,87" id="srcline87"> 87</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="120,88" id="srcline88"> 88</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="120,89" id="srcline89"> 89</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="120,90" id="srcline90"> 90</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="120,91" id="srcline91"> 91</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="120,92" id="srcline92"> 92</a></span><span class="line">    <span class="comment">%-- Rigid task Space --%</span></span></span>
<span class="srcline"><span class="lineno"><a href="120,93" id="srcline93"> 93</a></span><span class="line">    <span class="comment">%tasks: w0, tee</span></span></span>
<span class="srcline"><span class="lineno"><a href="120,94" id="srcline94"> 94</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="120,95" id="srcline95"> 95</a></span><span class="line">    <span class="mxinfo " id="T4:U346"><span class="var type1" id="S70T4U506">Hw</span>  = <span class="mxinfo " id="T4:U348"><span class="var type1" id="S41T27U508">H0</span>(<span class="mxinfo " id="T36:U350">1:3</span>,<span class="mxinfo " id="T36:U351">1:3</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="120,96" id="srcline96"> 96</a></span><span class="line">    <span class="mxinfo " id="T4:U352"><span class="var type1" id="S71T4U517">HwL</span> = <span class="mxinfo " id="T4:U354"><span class="var type1" id="S41T27U519">H0</span>(<span class="mxinfo " id="T36:U356">1:3</span>,<span class="mxinfo " id="T36:U357">4:6</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="120,97" id="srcline97"> 97</a></span><span class="line">    <span class="mxinfo " id="T4:U358"><span class="var type1" id="S72T4U528">HL</span>  = <span class="mxinfo " id="T4:U360"><span class="var type1" id="S41T27U530">H0</span>(<span class="mxinfo " id="T36:U362">4:6</span>,<span class="mxinfo " id="T36:U363">4:6</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="120,98" id="srcline98"> 98</a></span><span class="line">    <span class="mxinfo " id="T108:U364"><span class="var type1" id="S73T108U539">Hwq</span> = <span class="mxinfo " id="T108:U366"><span class="var type1" id="S42T29U541">H0q</span>(<span class="mxinfo " id="T36:U368">1:3</span>,<span class="mxinfo " id="T109:U369">:</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="120,99" id="srcline99"> 99</a></span><span class="line">    <span class="mxinfo " id="T108:U370"><span class="var type1" id="S74T108U548">HLq</span> = <span class="mxinfo " id="T108:U372"><span class="var type1" id="S42T29U550">H0q</span>(<span class="mxinfo " id="T36:U374">4:6</span>,<span class="mxinfo " id="T109:U375">:</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="120,100" id="srcline100">100</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="120,101" id="srcline101">101</a></span><span class="line">    <span class="mxinfo " id="T4:U376"><span class="var type1" id="S75T4U557">Hwdot</span>  = <span class="mxinfo " id="T4:U378"><span class="var type1" id="S66T27U559">H0_dot</span>(<span class="mxinfo " id="T36:U380">1:3</span>,<span class="mxinfo " id="T36:U381">1:3</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="120,102" id="srcline102">102</a></span><span class="line">    <span class="mxinfo " id="T4:U382"><span class="var type1" id="S76T4U568">HwLdot</span> = <span class="mxinfo " id="T4:U384"><span class="var type1" id="S66T27U570">H0_dot</span>(<span class="mxinfo " id="T36:U386">1:3</span>,<span class="mxinfo " id="T36:U387">4:6</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="120,103" id="srcline103">103</a></span><span class="line">    <span class="mxinfo " id="T4:U388"><span class="var type1" id="S77T4U579">HLdot</span>  = <span class="mxinfo " id="T4:U390"><span class="var type1" id="S66T27U581">H0_dot</span>(<span class="mxinfo " id="T46:U392"><span class="mxinfo " id="T5:U393">4</span>:<span class="mxinfo " id="T5:U394">6</span></span>,<span class="mxinfo " id="T46:U395"><span class="mxinfo " id="T5:U396">4</span>:<span class="mxinfo " id="T5:U397">6</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="120,104" id="srcline104">104</a></span><span class="line">    <span class="mxinfo " id="T108:U398"><span class="var type1" id="S78T108U590">Hwqdot</span> = <span class="mxinfo " id="T108:U400"><span class="var type1" id="S67T29U592">H0q_dot</span>(<span class="mxinfo " id="T36:U402">1:3</span>,<span class="mxinfo " id="T109:U403">:</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="120,105" id="srcline105">105</a></span><span class="line">    <span class="mxinfo " id="T108:U404"><span class="var type1" id="S79T108U599">HLqdot</span> = <span class="mxinfo " id="T108:U406"><span class="var type1" id="S67T29U601">H0q_dot</span>(<span class="mxinfo " id="T36:U408">4:6</span>,<span class="mxinfo " id="T109:U409">:</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="120,106" id="srcline106">106</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="120,107" id="srcline107">107</a></span><span class="line">    <span class="mxinfo " id="T4:U410"><span class="var type1" id="S80T4U608">invHL</span> = <span class="mxinfo " id="T4:U412">inv(<span class="var type1" id="S72T4U611">HL</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="120,108" id="srcline108">108</a></span><span class="line">    <span class="mxinfo " id="T108:U414"><span class="var type1" id="S82T108U614">Jomega</span> = <span class="mxinfo " id="T108:U416"><span class="mxinfo " id="T4:U417">-(<span class="mxinfo " id="T4:U418"><span class="var type1" id="S70T4U619">Hw</span>-<span class="mxinfo " id="T4:U420"><span class="mxinfo " id="T4:U421"><span class="var type1" id="S71T4U622">HwL</span>*<span class="var type1" id="S80T4U623">invHL</span></span>*<span class="mxinfo " id="T4:U424"><span class="var type1" id="S71T4U625">HwL</span>'</span></span></span>)</span>*(<span class="mxinfo " id="T108:U426"><span class="var type1" id="S73T108U628">Hwq</span>-<span class="mxinfo " id="T108:U428"><span class="mxinfo " id="T4:U429"><span class="var type1" id="S71T4U631">HwL</span>*<span class="var type1" id="S80T4U632">invHL</span></span>*<span class="var type1" id="S74T108U633">HLq</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="120,109" id="srcline109">109</a></span><span class="line">    <span class="comment">% Jomega_dot = Hwdot*Hwq + Hw*Hwqdot-HwLdot*invHL*HwL'*Hwq-HwL*inv(HLdot)*HwL'*Hwq-HwL*invHL*HwLdot'*Hwq-HwL*invHL*HwL'*Hwqdot<span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="120,110" id="srcline110">110</a></span><span class="line">    <span class="comment">%             -Hwdot*HwL*invHL*HLq-Hw*HwLdot*invHL*HLq-Hw*HwL*inv(HLdot)*HLq-Hw*HwL*invHL*HLqdot<span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="120,111" id="srcline111">111</a></span><span class="line">    <span class="comment">%             +HwLdot*invHL*HwL'*HwL*invHL*HLq+HwL*inv(HLdot)*HwL'*HwL*invHL*HLq+HwL*invHL*HwLdot'*HwL*invHL*HLq+HwL*invHL*HwL'*HwLdot*invHL*HLq<span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="120,112" id="srcline112">112</a></span><span class="line">    <span class="comment">%             +HwL*invHL*HwL'*HwL*inv(HLdot)*HLq+HwL*invHL*HwL'*HwL*invHL*HLqdot; </span></span></span>
<span class="srcline"><span class="lineno"><a href="120,113" id="srcline113">113</a></span><span class="line">    <span class="comment">% Jomega_dot = Hwdot*Hwq + Hw*Hwqdot-HwLdot*invHL*HwL'*Hwq-HwL*inv(HLdot)*HwL'*Hwq-HwL*invHL*HwLdot'*Hwq-HwL*invHL*HwL'*Hwqdot<span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="120,114" id="srcline114">114</a></span><span class="line">    <span class="comment">%             -Hwdot*HwL*invHL*HLq-Hw*HwLdot*invHL*HLq-Hw*HwL*inv(HLdot)*HLq-Hw*HwL*invHL*HLqdot<span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="120,115" id="srcline115">115</a></span><span class="line">    <span class="comment">%             +HwLdot*invHL*HwL'*HwL*invHL*HLq+HwL*inv(HLdot)*HwL'*HwL*invHL*HLq+HwL*invHL*HwLdot'*HwL*invHL*HLq+HwL*invHL*HwL'*HwLdot*invHL*HLq<span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="120,116" id="srcline116">116</a></span><span class="line">    <span class="comment">%             +HwL*invHL*HwL'*HwL*inv(HLdot)*HLq+HwL*invHL*HwL'*HwL*invHL*HLqdot; </span></span></span>
<span class="srcline"><span class="lineno"><a href="120,117" id="srcline117">117</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="120,118" id="srcline118">118</a></span><span class="line">    <span class="mxinfo " id="T108:U433"><span class="var type1" id="S83T108U636">Jomega_dot</span> = <span class="mxinfo " id="T108:U435"><span class="mxinfo " id="T108:U436"><span class="mxinfo " id="T108:U437"><span class="mxinfo " id="T108:U438"><span class="mxinfo " id="T108:U439"><span class="mxinfo " id="T108:U440"><span class="mxinfo " id="T108:U441"><span class="mxinfo " id="T108:U442"><span class="mxinfo " id="T108:U443"><span class="mxinfo " id="T108:U444"><span class="mxinfo " id="T108:U445"><span class="mxinfo " id="T108:U446"><span class="var type1" id="S75T4U649">Hwdot</span>*<span class="var type1" id="S73T108U650">Hwq</span></span> + <span class="mxinfo " id="T108:U449"><span class="var type1" id="S70T4U652">Hw</span>*<span class="var type1" id="S78T108U653">Hwqdot</span></span></span>-<span class="mxinfo " id="T108:U452"><span class="mxinfo " id="T4:U453"><span class="mxinfo " id="T4:U454"><span class="var type1" id="S76T4U657">HwLdot</span>*<span class="var type1" id="S80T4U658">invHL</span></span>*<span class="mxinfo " id="T4:U457"><span class="var type1" id="S71T4U660">HwL</span>'</span></span>*<span class="var type1" id="S73T108U661">Hwq</span></span></span>-<span class="mxinfo " id="T108:U460"><span class="mxinfo " id="T4:U461"><span class="mxinfo " id="T4:U462"><span class="var type1" id="S71T4U665">HwL</span>*<span class="var type1" id="S80T4U666">invHL</span></span>*<span class="mxinfo " id="T4:U465"><span class="var type1" id="S76T4U668">HwLdot</span>'</span></span>*<span class="var type1" id="S73T108U669">Hwq</span></span></span>-<span class="mxinfo " id="T108:U468"><span class="mxinfo " id="T4:U469"><span class="mxinfo " id="T4:U470"><span class="var type1" id="S71T4U673">HwL</span>*<span class="var type1" id="S80T4U674">invHL</span></span>*<span class="mxinfo " id="T4:U473"><span class="var type1" id="S71T4U676">HwL</span>'</span></span>*<span class="var type1" id="S78T108U677">Hwqdot</span></span></span><span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="120,119" id="srcline119">119</a></span><span class="line">                -<span class="mxinfo " id="T108:U476"><span class="mxinfo " id="T4:U477"><span class="mxinfo " id="T4:U478"><span class="var type1" id="S75T4U681">Hwdot</span>*<span class="var type1" id="S71T4U682">HwL</span></span>*<span class="var type1" id="S80T4U683">invHL</span></span>*<span class="var type1" id="S74T108U684">HLq</span></span></span>-<span class="mxinfo " id="T108:U483"><span class="mxinfo " id="T4:U484"><span class="mxinfo " id="T4:U485"><span class="var type1" id="S70T4U688">Hw</span>*<span class="var type1" id="S76T4U689">HwLdot</span></span>*<span class="var type1" id="S80T4U690">invHL</span></span>*<span class="var type1" id="S74T108U691">HLq</span></span></span>-<span class="mxinfo " id="T108:U490"><span class="mxinfo " id="T4:U491"><span class="mxinfo " id="T4:U492"><span class="var type1" id="S70T4U695">Hw</span>*<span class="var type1" id="S71T4U696">HwL</span></span>*<span class="var type1" id="S80T4U697">invHL</span></span>*<span class="var type1" id="S79T108U698">HLqdot</span></span></span><span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="120,120" id="srcline120">120</a></span><span class="line">                +<span class="mxinfo " id="T108:U497"><span class="mxinfo " id="T4:U498"><span class="mxinfo " id="T4:U499"><span class="mxinfo " id="T4:U500"><span class="mxinfo " id="T4:U501"><span class="var type1" id="S76T4U704">HwLdot</span>*<span class="var type1" id="S80T4U705">invHL</span></span>*<span class="mxinfo " id="T4:U504"><span class="var type1" id="S71T4U707">HwL</span>'</span></span>*<span class="var type1" id="S71T4U708">HwL</span></span>*<span class="var type1" id="S80T4U709">invHL</span></span>*<span class="var type1" id="S74T108U710">HLq</span></span></span>+<span class="mxinfo " id="T108:U509"><span class="mxinfo " id="T4:U510"><span class="mxinfo " id="T4:U511"><span class="mxinfo " id="T4:U512"><span class="mxinfo " id="T4:U513"><span class="var type1" id="S71T4U716">HwL</span>*<span class="var type1" id="S80T4U717">invHL</span></span>*<span class="mxinfo " id="T4:U516"><span class="var type1" id="S76T4U719">HwLdot</span>'</span></span>*<span class="var type1" id="S71T4U720">HwL</span></span>*<span class="var type1" id="S80T4U721">invHL</span></span>*<span class="var type1" id="S74T108U722">HLq</span></span></span>+<span class="mxinfo " id="T108:U521"><span class="mxinfo " id="T4:U522"><span class="mxinfo " id="T4:U523"><span class="mxinfo " id="T4:U524"><span class="mxinfo " id="T4:U525"><span class="var type1" id="S71T4U728">HwL</span>*<span class="var type1" id="S80T4U729">invHL</span></span>*<span class="mxinfo " id="T4:U528"><span class="var type1" id="S71T4U731">HwL</span>'</span></span>*<span class="var type1" id="S76T4U732">HwLdot</span></span>*<span class="var type1" id="S80T4U733">invHL</span></span>*<span class="var type1" id="S74T108U734">HLq</span></span></span><span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="120,121" id="srcline121">121</a></span><span class="line">                +<span class="mxinfo " id="T108:U533"><span class="mxinfo " id="T4:U534"><span class="mxinfo " id="T4:U535"><span class="mxinfo " id="T4:U536"><span class="mxinfo " id="T4:U537"><span class="var type1" id="S71T4U740">HwL</span>*<span class="var type1" id="S80T4U741">invHL</span></span>*<span class="mxinfo " id="T4:U540"><span class="var type1" id="S71T4U743">HwL</span>'</span></span>*<span class="var type1" id="S71T4U744">HwL</span></span>*<span class="var type1" id="S80T4U745">invHL</span></span>*<span class="var type1" id="S79T108U746">HLqdot</span></span></span></span>; </span></span>
<span class="srcline"><span class="lineno"><a href="120,122" id="srcline122">122</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="120,123" id="srcline123">123</a></span><span class="line">    <span class="mxinfo " id="T29:U545"><span class="var type1" id="S84T29U749">JEE_star</span> = <span class="mxinfo " id="T29:U547"><span class="var type1" id="S54T29U751">JmEE</span>-<span class="mxinfo " id="T29:U549"><span class="mxinfo " id="T27:U550"><span class="var type1" id="S53T27U754">J0EE</span>*<span class="mxinfo " id="T27:U552">inv(<span class="var type1" id="S41T27U757">H0</span>)</span></span>*<span class="var type1" id="S42T29U758">H0q</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="120,124" id="srcline124">124</a></span><span class="line">    <span class="mxinfo " id="T29:U555"><span class="var type1" id="S85T29U761">JEE_star_dot</span> =<span class="mxinfo " id="T29:U557"><span class="mxinfo " id="T29:U558"><span class="mxinfo " id="T29:U559"><span class="var type1" id="S57T29U765">JmEEdot</span>-<span class="mxinfo " id="T29:U561"><span class="mxinfo " id="T27:U562"><span class="var type1" id="S56T27U768">J0EEdot</span>*<span class="mxinfo " id="T27:U564">inv(<span class="var type1" id="S41T27U771">H0</span>)</span></span>*<span class="var type1" id="S42T29U772">H0q</span></span></span>-<span class="mxinfo " id="T29:U567"><span class="mxinfo " id="T27:U568"><span class="var type1" id="S53T27U775">J0EE</span>*<span class="mxinfo " id="T27:U570">inv(<span class="var type1" id="S66T27U778">H0_dot</span>)</span></span>*<span class="var type1" id="S42T29U779">H0q</span></span></span>-<span class="mxinfo " id="T29:U573"><span class="mxinfo " id="T27:U574"><span class="var type1" id="S53T27U782">J0EE</span>*<span class="mxinfo " id="T27:U576">inv(<span class="var type1" id="S41T27U785">H0</span>)</span></span>*<span class="var type1" id="S67T29U786">H0q_dot</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="120,125" id="srcline125">125</a></span><span class="line">    <span class="mxinfo " id="T30:U579"><span class="var type1" id="S86T30U789">J</span> = <span class="mxinfo " id="T30:U581">[<span class="var type1" id="S82T108U792">Jomega</span>;<span class="var type1" id="S84T29U794">JEE_star</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="120,126" id="srcline126">126</a></span><span class="line">    <span class="mxinfo " id="T30:U584"><span class="var type1" id="S87T30U797">Jdot</span> = <span class="mxinfo " id="T30:U586">[<span class="var type1" id="S83T108U800">Jomega_dot</span>;<span class="var type1" id="S85T29U802">JEE_star_dot</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="120,127" id="srcline127">127</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="120,128" id="srcline128">128</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="120,129" id="srcline129">129</a></span><span class="line"><span class="comment">%     invH0 = inv(H0);</span></span></span>
<span class="srcline"><span class="lineno"><a href="120,130" id="srcline130">130</a></span><span class="line"><span class="comment">%     M_star = Hq-H0q'*invH0*H0q;</span></span></span>
<span class="srcline"><span class="lineno"><a href="120,131" id="srcline131">131</a></span><span class="line"><span class="comment">%     D_star = Cq -(Cq0-H0q'*invH0*C0)*invH0*H0q -H0q'*invH0*C0q;</span></span></span>
<span class="srcline"><span class="lineno"><a href="120,132" id="srcline132">132</a></span><span class="line"><span class="comment">%     Dh_star = (Cq0-H0q'*invH0*C0)*invH0;</span></span></span>
<span class="srcline"><span class="lineno"><a href="120,133" id="srcline133">133</a></span><span class="line"><span class="comment">% </span></span></span>
<span class="srcline"><span class="lineno"><a href="120,134" id="srcline134">134</a></span><span class="line"><span class="comment">% </span></span></span>
<span class="srcline"><span class="lineno"><a href="120,135" id="srcline135">135</a></span><span class="line"><span class="comment">% </span></span></span>
<span class="srcline"><span class="lineno"><a href="120,136" id="srcline136">136</a></span><span class="line"><span class="comment">%     %if initial momentum null</span></span></span>
<span class="srcline"><span class="lineno"><a href="120,137" id="srcline137">137</a></span><span class="line"><span class="comment">%     Mq_diamond = Hq -H0q.'*invH0*H0q;</span></span></span>
<span class="srcline"><span class="lineno"><a href="120,138" id="srcline138">138</a></span><span class="line"><span class="comment">% %     Dq_diamond = Cq - Cq0*invH0*C0q + H0q.'*invH0*C0*invH0*H0q;</span></span></span>
<span class="srcline"><span class="lineno"><a href="120,139" id="srcline139">139</a></span><span class="line"><span class="comment">%     %else</span></span></span>
<span class="srcline"><span class="lineno"><a href="120,140" id="srcline140">140</a></span><span class="line"><span class="comment">%     Dq_diamond  = Cq - H0q.'*invH0*C0q;</span></span></span>
<span class="srcline"><span class="lineno"><a href="120,141" id="srcline141">141</a></span><span class="line"><span class="comment">%     Dq0_diamond = Cq0 - H0q.'*invH0*C0;</span></span></span>
<span class="srcline"><span class="lineno"><a href="120,142" id="srcline142">142</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="120,143" id="srcline143">143</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="120,144" id="srcline144">144</a></span><span class="line">    <span class="comment">%%--Dyn diamond --%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="120,145" id="srcline145">145</a></span><span class="line">    <span class="mxinfo " id="T27:U589"><span class="var type1" id="S88T27U805">invH0</span> = <span class="mxinfo " id="T27:U591">inv(<span class="var type1" id="S41T27U808">H0</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="120,146" id="srcline146">146</a></span><span class="line">    <span class="mxinfo " id="T30:U593"><span class="var type1" id="S89T30U811">M_diamond</span> = <span class="mxinfo " id="T30:U595"><span class="var type1" id="S43T30U813">Hq</span> -<span class="mxinfo " id="T30:U597"><span class="mxinfo " id="T31:U598"><span class="mxinfo " id="T31:U599"><span class="var type1" id="S42T29U817">H0q</span>'</span>*<span class="var type1" id="S88T27U818">invH0</span></span>*<span class="var type1" id="S42T29U819">H0q</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="120,147" id="srcline147">147</a></span><span class="line">    <span class="mxinfo " id="T30:U603"><span class="var type1" id="S90T30U822">D_diamond</span> = <span class="mxinfo " id="T30:U605"><span class="mxinfo " id="T30:U606"><span class="var type1" id="S48T30U825">Cq</span> -<span class="mxinfo " id="T30:U608"><span class="mxinfo " id="T31:U609">(<span class="mxinfo " id="T31:U610"><span class="var type1" id="S47T31U830">Cq0</span>-<span class="mxinfo " id="T31:U612"><span class="mxinfo " id="T31:U613"><span class="mxinfo " id="T31:U614"><span class="var type1" id="S42T29U834">H0q</span>'</span>*<span class="var type1" id="S88T27U835">invH0</span></span>*<span class="var type1" id="S45T27U836">C0</span></span></span>)*<span class="var type1" id="S88T27U837">invH0</span></span>*<span class="var type1" id="S42T29U838">H0q</span></span></span> -<span class="mxinfo " id="T30:U620"><span class="mxinfo " id="T31:U621"><span class="mxinfo " id="T31:U622"><span class="var type1" id="S42T29U842">H0q</span>'</span>*<span class="var type1" id="S88T27U843">invH0</span></span>*<span class="var type1" id="S46T29U844">C0q</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="120,148" id="srcline148">148</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="120,149" id="srcline149">149</a></span><span class="line">    <span class="comment">%%--Dyn star --%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="120,150" id="srcline150">150</a></span><span class="line">    <span class="mxinfo " id="T30:U626"><span class="var type1" id="S4T30U847">M_star</span> = <span class="mxinfo " id="T30:U628"><span class="var type1" id="S89T30U849">M_diamond</span>*<span class="mxinfo " id="T30:U630">inv(<span class="var type1" id="S86T30U852">J</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="120,151" id="srcline151">151</a></span><span class="line">    <span class="mxinfo " id="T30:U632"><span class="var type1" id="S5T30U855">D_star</span> = <span class="var type1" id="S90T30U856">D_diamond</span></span>;<span class="comment">%-M_diamond*inv(J)*Jdot;</span></span></span>
<span class="srcline"><span class="lineno"><a href="120,152" id="srcline152">152</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="120,153" id="srcline153">153</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="120,154" id="srcline154">154</a></span><span class="line">    <span class="mxinfo " id="T3:U635"><span class="var type1" id="S91T3U859">w1</span> = <span class="mxinfo " id="T3:U637"><span class="var type1" id="S13T2U861">u0</span>(<span class="mxinfo " id="T36:U639">1:3</span>,<span class="mxinfo " id="T37:U640">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="120,155" id="srcline155">155</a></span><span class="line">    <span class="mxinfo " id="T2:U641"><span class="var type1" id="S92T2U868">w2</span> = <span class="var type1" id="S50T2U869">u_EE</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="120,156" id="srcline156">156</a></span><span class="line">    <span class="mxinfo " id="T1:U644"><span class="var type1" id="S3T1U872">w</span> = <span class="mxinfo " id="T1:U646">[<span class="var type1" id="S91T3U875">w1</span>;<span class="var type1" id="S92T2U877">w2</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="120,157" id="srcline157">157</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="120,158" id="srcline158">158</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="120,159" id="srcline159">159</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="120,160" id="srcline160">160</a></span><span class="line"><span class="mxinfo " id="T30:U649"><span class="var type1" id="S93T30U880">M_star_inv</span> = <span class="mxinfo " id="T30:U651">inv(<span class="var type1" id="S4T30U883">M_star</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="120,161" id="srcline161">161</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="120,162" id="srcline162">162</a></span><span class="line"><span class="mxinfo " id="T1:U653"><span class="var type1" id="S2T1U886">tau_ndi_qc</span> =<span class="mxinfo " id="T1:U655"><span class="mxinfo " id="T1:U656"><span class="mxinfo " id="T1:U657"><span class="mxinfo " id="T30:U658"><span class="var type1" id="S4T30U891">M_star</span>* <span class="mxinfo " id="T30:U660"><span class="var type1" id="S14T104U894">robot_unc_pre</span>.control.Kp</span></span>*(<span class="mxinfo " id="T1:U662"><span class="var type1" id="S6T1U899">w_ref</span>-<span class="var type1" id="S3T1U900">w</span></span>)</span> +<span class="mxinfo " id="T1:U665"><span class="mxinfo " id="T30:U666"><span class="var type1" id="S4T30U903">M_star</span>* <span class="mxinfo " id="T30:U668"><span class="var type1" id="S14T104U906">robot_unc_pre</span>.control.Kv</span></span>*(<span class="mxinfo " id="T1:U670"><span class="var type1" id="S7T1U911">w_ref_int</span>-<span class="var type1" id="S8T5U912">w_int</span></span>)</span></span> +<span class="mxinfo " id="T1:U673"><span class="var type1" id="S5T30U914">D_star</span>*<span class="var type1" id="S3T1U915">w</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="120,163" id="srcline163">163</a></span><span class="line"><span class="comment">% tau_ndi_qc =M_star* robot_unc_pre.control.Kp*(w_ref-w)  +D_star*w;</span></span></span>
</pre>
</body>
</html>
