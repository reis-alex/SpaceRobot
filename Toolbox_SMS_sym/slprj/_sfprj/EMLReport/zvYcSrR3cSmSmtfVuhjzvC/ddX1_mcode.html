<!-- saved from url=(0014)about:internet -->
<html>
<body>
<script src="resources/eml_report_loadable_data.js"></script>
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1" id="srcline1">  1</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T1U3">umdot</span>,<span class="var type1" id="S3T2U4">u0dot</span>,<span class="var type1" id="S4T2U5">moment_system</span>,<span class="var type1" id="S5T2U6">u_t</span>,<span class="var type1" id="S6T2U7">u_EE</span>,<span class="var type1" id="S7T3U8">rL_target</span>,<span class="var type1" id="S8T3U9">rL_EE</span>,<span class="var type1" id="S9T2U10">Fe</span>] = ddX(<span class="var type1" id="S10T4U13">R0</span>,<span class="var type1" id="S11T3U14">r0</span>,<span class="var type1" id="S12T1U15">qm</span>,<span class="var type1" id="S13T2U16">u0</span>,<span class="var type1" id="S14T1U17">um</span>,<span class="var type1" id="S15T2U18">w_0</span>,<span class="var type1" id="S16T5U19">w_m</span>,<span class="var type1" id="S17T5U20">is_captured</span>,<span class="var type1" id="S18T2U21">u_t_init</span>,<span class="var type2" id="S19T6V1U22">robot_pre_sim</span>,<span class="var type2" id="S20T19V2U23">target_sim</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,2" id="srcline2">  2</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,3" id="srcline3">  3</a></span><span class="line"><span class="comment">% :inputs:</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,4" id="srcline4">  4</a></span><span class="line"><span class="comment">%   * R0 -- Rotation matrix from the base-link CCS to the inertial CCS -- [3x3].</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,5" id="srcline5">  5</a></span><span class="line"><span class="comment">%   * r0 -- Position of the base-link center-of-mass with respect to the origin of the inertial frame,</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,6" id="srcline6">  6</a></span><span class="line"><span class="comment">%projected in the inertial CCS -- [3x1].</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,7" id="srcline7">  7</a></span><span class="line"><span class="comment">%   * qm -- Displacements of the active joints -- [n_qx1].</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,8" id="srcline8">  8</a></span><span class="line"><span class="comment">%   * eta -- Modal</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,9" id="srcline9">  9</a></span><span class="line"><span class="comment">%   * u0 -- Base-link velocities [\omega,rdot]. The angular velocity is projected in the body-fixed CCS,</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,10" id="srcline10"> 10</a></span><span class="line"><span class="comment">%while the linear velocity is projected in the inertial CCS -- [6x1].</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,11" id="srcline11"> 11</a></span><span class="line"><span class="comment">%   * um -- Joint velocities -- [n_qx1].</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,12" id="srcline12"> 12</a></span><span class="line"><span class="comment">%   * robot -- Robot model (see :doc:`/Tutorial_Robot`).</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,13" id="srcline13"> 13</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,14" id="srcline14"> 14</a></span><span class="line"><span class="comment">%--- System_dimension ---%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,15" id="srcline15"> 15</a></span><span class="line"><span class="mxinfo " id="T5:U20"><span class="var type1" id="S21T5U26">dim_0</span> = <span class="mxinfo " id="T5:U22">6</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,16" id="srcline16"> 16</a></span><span class="line"><span class="mxinfo " id="T5:U23"><span class="var type1" id="S22T5U30">dim_m</span> = <span class="mxinfo " id="T5:U25"><span class="var type1" id="S19T6U32">robot_pre_sim</span>.n_q</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,17" id="srcline17"> 17</a></span><span class="line"><span class="mxinfo " id="T5:U27"><span class="var type1" id="S23T5U36">dim_r</span> = <span class="mxinfo " id="T5:U29"><span class="mxinfo " id="T18:U30"><span class="var type1" id="S19T6U39">robot_pre_sim</span>.dimensions</span>.dim_r</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,18" id="srcline18"> 18</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,19" id="srcline19"> 19</a></span><span class="line"><span class="comment">%-- memory allocation --%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,20" id="srcline20"> 20</a></span><span class="line"><span class="mxinfo " id="T22:U32"><span class="var type1" id="S24T22U44">ddX</span> = <span class="mxinfo " id="T22:U34">zeros(<span class="mxinfo " id="T5:U35"><span class="var type1" id="S21T5U48">dim_0</span>+<span class="var type1" id="S22T5U49">dim_m</span></span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,21" id="srcline21"> 21</a></span><span class="line"><span class="mxinfo " id="T2:U38"><span class="var type1" id="S3T2U53">u0dot</span> = <span class="mxinfo " id="T2:U40">zeros(<span class="var type1" id="S21T5U56">dim_0</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,22" id="srcline22"> 22</a></span><span class="line"><span class="mxinfo " id="T1:U42"><span class="var type1" id="S2T1U60">umdot</span> = <span class="mxinfo " id="T1:U44">zeros(<span class="var type1" id="S22T5U63">dim_m</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,23" id="srcline23"> 23</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,24" id="srcline24"> 24</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,25" id="srcline25"> 25</a></span><span class="line"><span class="comment">%-- SERVICER --% </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,26" id="srcline26"> 26</a></span><span class="line"><span class="comment">%--- Kinematics ---%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,27" id="srcline27"> 27</a></span><span class="line"><span class="comment">%Kinematics</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,28" id="srcline28"> 28</a></span><span class="line">[<span class="mxinfo " id="T23:U46">~</span>,<span class="var type1" id="S26T23U69">RL</span>,<span class="mxinfo " id="T24:U48">~</span>,<span class="var type1" id="S27T24U71">rL</span>,<span class="var type1" id="S28T24U72">e</span>,<span class="var type1" id="S29T24U73">g</span>]    =   <span class="fcn" id="F2N14:B75">Kinematics</span>(<span class="var type1" id="S10T4U76">R0</span>,<span class="var type1" id="S11T3U77">r0</span>,<span class="var type1" id="S12T1U78">qm</span>,<span class="var type1" id="S19T6U79">robot_pre_sim</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,29" id="srcline29"> 29</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,30" id="srcline30"> 30</a></span><span class="line"><span class="comment">%Diferential Kinematics</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,31" id="srcline31"> 31</a></span><span class="line">[<span class="var type1" id="S31T25U83">Bij</span>,<span class="var type1" id="S32T26U84">Bi0</span>,<span class="var type1" id="S33T27U85">P0</span>,<span class="var type1" id="S34T28U86">pm</span>]     =   <span class="fcn" id="F57N5:B88">DiffKinematics</span>(<span class="var type1" id="S10T4U89">R0</span>,<span class="var type1" id="S11T3U90">r0</span>,<span class="var type1" id="S27T24U91">rL</span>,<span class="var type1" id="S28T24U92">e</span>,<span class="var type1" id="S29T24U93">g</span>,<span class="var type1" id="S19T6U94">robot_pre_sim</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,32" id="srcline32"> 32</a></span><span class="line"><span class="comment">%Velocities</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,33" id="srcline33"> 33</a></span><span class="line">[<span class="var type1" id="S36T2U98">t0</span>,<span class="var type1" id="S37T28U99">tL</span>]             =   <span class="fcn" id="F60N19:B101">Velocities</span>(<span class="var type1" id="S31T25U102">Bij</span>,<span class="var type1" id="S32T26U103">Bi0</span>,<span class="var type1" id="S33T27U104">P0</span>,<span class="var type1" id="S34T28U105">pm</span>,<span class="var type1" id="S13T2U106">u0</span>,<span class="var type1" id="S14T1U107">um</span>,<span class="var type1" id="S19T6U108">robot_pre_sim</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,34" id="srcline34"> 34</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,35" id="srcline35"> 35</a></span><span class="line"><span class="comment">%--- Dynamics ---%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,36" id="srcline36"> 36</a></span><span class="line"><span class="comment">%Inertias in inertial frames</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,37" id="srcline37"> 37</a></span><span class="line">[<span class="var type1" id="S39T4U112">I0</span>,<span class="var type1" id="S40T23U113">Im</span>]             =   <span class="fcn" id="F68N10:B115">I_I</span>(<span class="var type1" id="S10T4U116">R0</span>,<span class="var type1" id="S26T23U117">RL</span>,<span class="var type1" id="S19T6U118">robot_pre_sim</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,38" id="srcline38"> 38</a></span><span class="line"><span class="comment">%Mass Composite Body matrix</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,39" id="srcline39"> 39</a></span><span class="line">[<span class="var type1" id="S42T27U122">M0_tilde</span>,<span class="var type1" id="S43T26U123">Mm_tilde</span>] =   <span class="fcn" id="F72N15:B125">MCB</span>(<span class="var type1" id="S39T4U126">I0</span>,<span class="var type1" id="S40T23U127">Im</span>,<span class="var type1" id="S31T25U128">Bij</span>,<span class="var type1" id="S32T26U129">Bi0</span>,<span class="var type1" id="S19T6U130">robot_pre_sim</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,40" id="srcline40"> 40</a></span><span class="line"><span class="comment">%Generalized Inertia matrix</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,41" id="srcline41"> 41</a></span><span class="line">[<span class="var type1" id="S45T27U134">H0</span>,<span class="var type1" id="S46T29U135">H0m</span>,<span class="var type1" id="S47T30U136">Hm</span>]         =   <span class="fcn" id="F101N7:B138">GIM</span>(<span class="var type1" id="S42T27U139">M0_tilde</span>,<span class="var type1" id="S43T26U140">Mm_tilde</span>,<span class="var type1" id="S31T25U141">Bij</span>,<span class="var type1" id="S32T26U142">Bi0</span>,<span class="var type1" id="S33T27U143">P0</span>,<span class="var type1" id="S34T28U144">pm</span>,<span class="var type1" id="S19T6U145">robot_pre_sim</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,42" id="srcline42"> 42</a></span><span class="line"><span class="comment">%Generalized Convective Inertia matrix</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,43" id="srcline43"> 43</a></span><span class="line">[<span class="var type1" id="S49T27U149">C0</span>, <span class="var type1" id="S50T29U150">C0m</span>, <span class="var type1" id="S51T31U151">Cm0</span>, <span class="var type1" id="S52T30U152">Cm</span>]  =   <span class="fcn" id="F109N2:B154">CIM</span>(<span class="var type1" id="S36T2U155">t0</span>,<span class="var type1" id="S37T28U156">tL</span>,<span class="var type1" id="S39T4U157">I0</span>,<span class="var type1" id="S40T23U158">Im</span>,<span class="var type1" id="S42T27U159">M0_tilde</span>,<span class="var type1" id="S43T26U160">Mm_tilde</span>,<span class="var type1" id="S31T25U161">Bij</span>,<span class="var type1" id="S32T26U162">Bi0</span>,<span class="var type1" id="S33T27U163">P0</span>,<span class="var type1" id="S34T28U164">pm</span>,<span class="var type1" id="S19T6U165">robot_pre_sim</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,44" id="srcline44"> 44</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,45" id="srcline45"> 45</a></span><span class="line"><span class="mxinfo " id="T32:U112"><span class="var type1" id="S54T32U168">H</span> =<span class="mxinfo " id="T32:U114">[<span class="mxinfo " id="T33:U115"><span class="var type1" id="S45T27U171">H0</span> <span class="var type1" id="S46T29U172">H0m</span></span>  ;<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,46" id="srcline46"> 46</a></span><span class="line">    <span class="mxinfo " id="T34:U118"><span class="mxinfo " id="T31:U119"><span class="var type1" id="S46T29U175">H0m</span>'</span> <span class="var type1" id="S47T30U176">Hm</span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,47" id="srcline47"> 47</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,48" id="srcline48"> 48</a></span><span class="line"><span class="mxinfo " id="T32:U122"><span class="var type1" id="S55T32U179">C</span> =<span class="mxinfo " id="T32:U124">[<span class="mxinfo " id="T33:U125"><span class="var type1" id="S49T27U182">C0</span> <span class="var type1" id="S50T29U183">C0m</span></span> ;<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,49" id="srcline49"> 49</a></span><span class="line">    <span class="mxinfo " id="T34:U128"><span class="var type1" id="S51T31U185">Cm0</span> <span class="var type1" id="S52T30U186">Cm</span></span> ]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,50" id="srcline50"> 50</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,51" id="srcline51"> 51</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,52" id="srcline52"> 52</a></span><span class="line"><span class="mxinfo " id="T2:U131"><span class="var type1" id="S56T2U189">moment_servicer</span> = <span class="mxinfo " id="T2:U133"><span class="mxinfo " id="T2:U134"><span class="var type1" id="S45T27U192">H0</span>*<span class="var type1" id="S13T2U193">u0</span></span>+<span class="mxinfo " id="T2:U137"><span class="var type1" id="S46T29U195">H0m</span>*<span class="var type1" id="S14T1U196">um</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,53" id="srcline53"> 53</a></span><span class="line"><span class="mxinfo " id="T2:U140"><span class="var type1" id="S6T2U199">u_EE</span>= <span class="mxinfo " id="T2:U142"><span class="var type1" id="S37T28U201">tL</span>(<span class="mxinfo " id="T35:U144">:</span>,<span class="mxinfo " id="T5:U145"><span class="var type1" id="S19T6U204">robot_pre_sim</span>.id_EE</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,54" id="srcline54"> 54</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,55" id="srcline55"> 55</a></span><span class="line"><span class="comment">%-- TARGET --%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,56" id="srcline56"> 56</a></span><span class="line"><span class="comment">%--- Kinematics ---%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,57" id="srcline57"> 57</a></span><span class="line"><span class="comment">%Kinematics</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,58" id="srcline58"> 58</a></span><span class="line">[<span class="mxinfo " id="T23:U147">~</span>,<span class="var type1" id="S26T23U210">RL</span>,<span class="mxinfo " id="T24:U149">~</span>,<span class="var type1" id="S27T24U212">rL</span>,<span class="var type1" id="S28T24U213">e</span>,<span class="var type1" id="S29T24U214">g</span>]    =   <span class="fcn" id="F115N14:B216">Kinematics</span>(<span class="var type1" id="S10T4U217">R0</span>,<span class="var type1" id="S11T3U218">r0</span>,<span class="var type1" id="S12T1U219">qm</span>,<span class="var type1" id="S20T19U220">target_sim</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,59" id="srcline59"> 59</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,60" id="srcline60"> 60</a></span><span class="line"><span class="comment">%Diferential Kinematics</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,61" id="srcline61"> 61</a></span><span class="line">[<span class="var type1" id="S31T25U224">Bij</span>,<span class="var type1" id="S32T26U225">Bi0</span>,<span class="var type1" id="S33T27U226">P0</span>,<span class="var type1" id="S34T28U227">pm</span>]     =   <span class="fcn" id="F116N5:B229">DiffKinematics</span>(<span class="var type1" id="S10T4U230">R0</span>,<span class="var type1" id="S11T3U231">r0</span>,<span class="var type1" id="S27T24U232">rL</span>,<span class="var type1" id="S28T24U233">e</span>,<span class="var type1" id="S29T24U234">g</span>,<span class="var type1" id="S20T19U235">target_sim</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,62" id="srcline62"> 62</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,63" id="srcline63"> 63</a></span><span class="line"><span class="comment">%--- Dynamics ---%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,64" id="srcline64"> 64</a></span><span class="line"><span class="comment">%Inertias in inertial frames</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,65" id="srcline65"> 65</a></span><span class="line">[<span class="var type1" id="S39T4U239">I0</span>,<span class="var type1" id="S40T23U240">Im</span>]             =   <span class="fcn" id="F117N10:B242">I_I</span>(<span class="var type1" id="S10T4U243">R0</span>,<span class="var type1" id="S26T23U244">RL</span>,<span class="var type1" id="S20T19U245">target_sim</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,66" id="srcline66"> 66</a></span><span class="line"><span class="comment">%Mass Composite Body matrix</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,67" id="srcline67"> 67</a></span><span class="line">[<span class="var type1" id="S42T27U249">M0_tilde</span>,<span class="var type1" id="S43T26U250">Mm_tilde</span>] =   <span class="fcn" id="F118N15:B252">MCB</span>(<span class="var type1" id="S39T4U253">I0</span>,<span class="var type1" id="S40T23U254">Im</span>,<span class="var type1" id="S31T25U255">Bij</span>,<span class="var type1" id="S32T26U256">Bi0</span>,<span class="var type1" id="S20T19U257">target_sim</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,68" id="srcline68"> 68</a></span><span class="line"><span class="comment">%Generalized Inertia matrix</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,69" id="srcline69"> 69</a></span><span class="line">[<span class="var type1" id="S57T27U261">H0_t</span>,<span class="mxinfo " id="T29:U180">~</span>,<span class="mxinfo " id="T30:U181">~</span>]         =   <span class="fcn" id="F122N7:B265">GIM</span>(<span class="var type1" id="S42T27U266">M0_tilde</span>,<span class="var type1" id="S43T26U267">Mm_tilde</span>,<span class="var type1" id="S31T25U268">Bij</span>,<span class="var type1" id="S32T26U269">Bi0</span>,<span class="var type1" id="S33T27U270">P0</span>,<span class="var type1" id="S34T28U271">pm</span>,<span class="var type1" id="S20T19U272">target_sim</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,70" id="srcline70"> 70</a></span><span class="line">[<span class="var type1" id="S58T27U276">C0_t</span>, <span class="mxinfo " id="T29:U190">~</span>, <span class="mxinfo " id="T31:U191">~</span>, <span class="mxinfo " id="T30:U192">~</span>]    =   <span class="fcn" id="F123N2:B281">CIM</span>(<span class="var type1" id="S36T2U282">t0</span>,<span class="var type1" id="S37T28U283">tL</span>,<span class="var type1" id="S39T4U284">I0</span>,<span class="var type1" id="S40T23U285">Im</span>,<span class="var type1" id="S42T27U286">M0_tilde</span>,<span class="var type1" id="S43T26U287">Mm_tilde</span>,<span class="var type1" id="S31T25U288">Bij</span>,<span class="var type1" id="S32T26U289">Bi0</span>,<span class="var type1" id="S33T27U290">P0</span>,<span class="var type1" id="S34T28U291">pm</span>,<span class="var type1" id="S20T19U292">target_sim</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,71" id="srcline71"> 71</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,72" id="srcline72"> 72</a></span><span class="line"><span class="mxinfo " id="T3:U204"><span class="var type1" id="S7T3U295">rL_target</span> = <span class="mxinfo " id="T3:U206"><span class="var type1" id="S27T24U297">rL</span>(<span class="mxinfo " id="T36:U208">:</span>,<span class="mxinfo " id="T5:U209"><span class="var type1" id="S20T19U300">target_sim</span>.id_target</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,73" id="srcline73"> 73</a></span><span class="line"><span class="mxinfo " id="T3:U211"><span class="var type1" id="S8T3U304">rL_EE</span>     = <span class="mxinfo " id="T3:U213"><span class="var type1" id="S27T24U306">rL</span>(<span class="mxinfo " id="T36:U215">:</span>,<span class="mxinfo " id="T5:U216"><span class="var type1" id="S20T19U309">target_sim</span>.id_EE</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,74" id="srcline74"> 74</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,75" id="srcline75"> 75</a></span><span class="line"><span class="keyword">if</span> <span class="var type1" id="S17T5U313">is_captured</span> </span></span>
<span class="srcline"><span class="lineno"><a href="1,76" id="srcline76"> 76</a></span><span class="line">    [<span class="var type1" id="S59T27U317">Jt0</span>, <span class="var type1" id="S60T29U318">Jtm</span>]      =   <span class="fcn" id="F126N12:B320">Jacob</span>(<span class="mxinfo " id="T3:U221"><span class="var type1" id="S27T24U322">rL</span>(<span class="mxinfo " id="T36:U223">:</span>,<span class="mxinfo " id="T37:U224"><span class="var type1" id="S20T19U325">target_sim</span>.id_target</span>)</span>,<span class="var type1" id="S11T3U327">r0</span>,<span class="var type1" id="S27T24U328">rL</span>,<span class="var type1" id="S33T27U329">P0</span>,<span class="var type1" id="S34T28U330">pm</span>,<span class="var type1" id="S20T19U332">target_sim</span>.id_target,<span class="var type1" id="S20T19U334">target_sim</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,77" id="srcline77"> 77</a></span><span class="line">    <span class="mxinfo " id="T2:U232"><span class="var type1" id="S5T2U337">u_t</span> = <span class="mxinfo " id="T2:U234"><span class="mxinfo " id="T2:U235"><span class="var type1" id="S59T27U340">Jt0</span>*<span class="var type1" id="S13T2U341">u0</span></span>+<span class="mxinfo " id="T2:U238"><span class="var type1" id="S60T29U343">Jtm</span>*<span class="var type1" id="S14T1U344">um</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,78" id="srcline78"> 78</a></span><span class="line">    [<span class="var type1" id="S62T27U348">Jt0dot</span>, <span class="var type1" id="S63T29U349">Jtmdot</span>]      =   <span class="fcn" id="F127N13:B351">Jacobdot</span>(<span class="mxinfo " id="T3:U243"><span class="var type1" id="S27T24U353">rL</span>(<span class="mxinfo " id="T36:U245">:</span>,<span class="mxinfo " id="T37:U246"><span class="var type1" id="S20T19U356">target_sim</span>.id_target</span>)</span>,<span class="var type1" id="S5T2U358">u_t</span>,<span class="var type1" id="S11T3U359">r0</span>,<span class="var type1" id="S13T2U360">u0</span>,<span class="var type1" id="S27T24U361">rL</span>,<span class="var type1" id="S37T28U362">tL</span>,<span class="var type1" id="S33T27U363">P0</span>,<span class="var type1" id="S34T28U364">pm</span>,<span class="var type1" id="S20T19U366">target_sim</span>.id_target,<span class="var type1" id="S20T19U368">target_sim</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,79" id="srcline79"> 79</a></span><span class="line">    <span class="mxinfo " id="T2:U257"><span class="var type1" id="S65T2U371">udot_t</span> = <span class="mxinfo " id="T2:U259"><span class="mxinfo " id="T2:U260"><span class="mxinfo " id="T2:U261"><span class="mxinfo " id="T2:U262"><span class="var type1" id="S59T27U376">Jt0</span>*<span class="var type1" id="S3T2U377">u0dot</span></span>+<span class="mxinfo " id="T2:U265"><span class="var type1" id="S60T29U379">Jtm</span>*<span class="var type1" id="S2T1U380">umdot</span></span></span> + <span class="mxinfo " id="T2:U268"><span class="var type1" id="S62T27U382">Jt0dot</span>*<span class="var type1" id="S13T2U383">u0</span></span></span>+<span class="mxinfo " id="T2:U271"><span class="var type1" id="S63T29U385">Jtmdot</span>*<span class="var type1" id="S14T1U386">um</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,80" id="srcline80"> 80</a></span><span class="line">    <span class="mxinfo " id="T33:U274"><span class="var type1" id="S66T33U389">J</span> = <span class="mxinfo " id="T33:U276">[<span class="var type1" id="S59T27U392">Jt0</span> <span class="var type1" id="S60T29U393">Jtm</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,81" id="srcline81"> 81</a></span><span class="line">    <span class="mxinfo " id="T33:U279"><span class="var type1" id="S67T33U396">Jdot</span> = <span class="mxinfo " id="T33:U281">[<span class="var type1" id="S62T27U399">Jt0dot</span> <span class="var type1" id="S63T29U400">Jtmdot</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,82" id="srcline82"> 82</a></span><span class="line">    <span class="mxinfo " id="T27:U284"><span class="var type1" id="S68T27U403">B_tEE</span> = <span class="mxinfo " id="T27:U286"><span class="var type1" id="S31T25U405">Bij</span>(<span class="mxinfo " id="T35:U288">:</span>,<span class="mxinfo " id="T35:U289">:</span>,<span class="mxinfo " id="T37:U290"><span class="var type1" id="S20T19U409">target_sim</span>.id_target</span>,<span class="mxinfo " id="T37:U292"><span class="var type1" id="S20T19U412">target_sim</span>.id_EE</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,83" id="srcline83"> 83</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,84" id="srcline84"> 84</a></span><span class="line">    <span class="mxinfo " id="T32:U294"><span class="var type1" id="S69T32U416">H_star</span> = <span class="mxinfo " id="T32:U296"><span class="var type1" id="S54T32U418">H</span> +<span class="mxinfo " id="T32:U298"><span class="mxinfo " id="T38:U299"><span class="mxinfo " id="T38:U300"><span class="mxinfo " id="T38:U301"><span class="var type1" id="S66T33U423">J</span>'</span>*<span class="mxinfo " id="T27:U303">inv(<span class="mxinfo " id="T27:U304"><span class="var type1" id="S68T27U427">B_tEE</span>'</span>)</span></span>*<span class="var type1" id="S57T27U428">H0_t</span></span>*<span class="var type1" id="S66T33U429">J</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,85" id="srcline85"> 85</a></span><span class="line">    <span class="mxinfo " id="T32:U308"><span class="var type1" id="S71T32U432">C_star</span> = <span class="mxinfo " id="T32:U310"><span class="mxinfo " id="T32:U311"><span class="var type1" id="S55T32U435">C</span> +<span class="mxinfo " id="T32:U313"><span class="mxinfo " id="T38:U314"><span class="mxinfo " id="T38:U315"><span class="mxinfo " id="T38:U316"><span class="var type1" id="S66T33U440">J</span>'</span>*<span class="mxinfo " id="T27:U318">inv(<span class="mxinfo " id="T27:U319"><span class="var type1" id="S68T27U444">B_tEE</span>'</span>)</span></span>*<span class="var type1" id="S58T27U445">C0_t</span></span>*<span class="var type1" id="S66T33U446">J</span></span></span>+<span class="mxinfo " id="T32:U323"><span class="mxinfo " id="T38:U324"><span class="mxinfo " id="T38:U325"><span class="mxinfo " id="T38:U326"><span class="var type1" id="S66T33U451">J</span>'</span>*<span class="mxinfo " id="T27:U328">inv(<span class="mxinfo " id="T27:U329"><span class="var type1" id="S68T27U455">B_tEE</span>'</span>)</span></span>*<span class="var type1" id="S57T27U456">H0_t</span></span>*<span class="var type1" id="S67T33U457">Jdot</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,86" id="srcline86"> 86</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,87" id="srcline87"> 87</a></span><span class="line">    <span class="mxinfo " id="T32:U333"><span class="var type1" id="S72T32U460">iMm</span> = <span class="mxinfo " id="T32:U335">inv(<span class="var type1" id="S69T32U463">H_star</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,88" id="srcline88"> 88</a></span><span class="line">    <span class="var type0" id="S24T0U466">ddX</span> = <span class="message error" id="M1F1C"><span class="var type1" id="S72T32U469">iMm</span> * <span class="mxinfo " id="T39:U338">[<span class="var type1" id="S15T2U472">w_0</span>;<span class="var type1" id="S16T5U474">w_m</span>]</span></span>- <span class="var type0" id="S72T0U477">iMm</span> * <span class="var type0" id="S71T0U478">C_star</span> * [<span class="var type0" id="S13T0U481">u0</span>;<span class="var type0" id="S14T0U483">um</span>];</span></span>
<span class="srcline"><span class="lineno"><a href="1,89" id="srcline89"> 89</a></span><span class="line">    <span class="var type0" id="S3T0U486">u0dot</span> = <span class="var type0" id="S24T0U488"><span class="message error" id="M2F1C">ddX</span></span>(1:<span class="var type0" id="S21T0U491">dim_0</span>,1);</span></span>
<span class="srcline"><span class="lineno"><a href="1,90" id="srcline90"> 90</a></span><span class="line">    <span class="var type0" id="S2T0U495">umdot</span>= <span class="var type0" id="S24T0U497"><span class="message error" id="M3F1C">ddX</span></span>(<span class="var type0" id="S21T0U500">dim_0</span>+1:<span class="var type0" id="S21T0U503">dim_0</span>+<span class="var type0" id="S22T0U504">dim_m</span>,1);</span></span>
<span class="srcline"><span class="lineno"><a href="1,91" id="srcline91"> 91</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,92" id="srcline92"> 92</a></span><span class="line">    <span class="mxinfo " id="T2:U341"><span class="var type1" id="S73T2U508">moment_t</span> = <span class="mxinfo " id="T2:U343"><span class="var type1" id="S57T27U510">H0_t</span> *<span class="var type1" id="S18T2U511">u_t_init</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,93" id="srcline93"> 93</a></span><span class="line">    <span class="mxinfo " id="T2:U346"><span class="var type1" id="S4T2U514">moment_system</span> = <span class="mxinfo " id="T2:U348"><span class="var type1" id="S56T2U516">moment_servicer</span>+<span class="var type1" id="S73T2U517">moment_t</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,94" id="srcline94"> 94</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,95" id="srcline95"> 95</a></span><span class="line">    <span class="mxinfo " id="T2:U351"><span class="var type1" id="S9T2U520">Fe</span> = <span class="mxinfo " id="T2:U353"><span class="mxinfo " id="T27:U354">-<span class="mxinfo " id="T27:U355"><span class="mxinfo " id="T27:U356">inv(<span class="var type1" id="S68T27U526">B_tEE</span>)</span>'</span></span>*(<span class="mxinfo " id="T2:U358"><span class="mxinfo " id="T2:U359"><span class="var type1" id="S57T27U530">H0_t</span>*<span class="var type1" id="S65T2U531">udot_t</span></span>+<span class="mxinfo " id="T2:U362"><span class="var type1" id="S58T27U533">C0_t</span>*<span class="var type1" id="S5T2U534">u_t</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,96" id="srcline96"> 96</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,97" id="srcline97"> 97</a></span><span class="line"><span class="keyword">else</span> </span></span>
<span class="srcline"><span class="lineno"><a href="1,98" id="srcline98"> 98</a></span><span class="line">    <span class="mxinfo " id="T2:U365"><span class="var type1" id="S73T2U538">moment_t</span> = <span class="mxinfo " id="T2:U367"><span class="var type1" id="S57T27U540">H0_t</span> *<span class="var type1" id="S18T2U541">u_t_init</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,99" id="srcline99"> 99</a></span><span class="line">    <span class="mxinfo " id="T2:U370"><span class="var type1" id="S5T2U544">u_t</span> = <span class="var type1" id="S18T2U545">u_t_init</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,100" id="srcline100">100</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,101" id="srcline101">101</a></span><span class="line">    <span class="mxinfo " id="T32:U373"><span class="var type1" id="S72T32U548">iMm</span> = <span class="mxinfo " id="T32:U375">inv(<span class="var type1" id="S54T32U551">H</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,102" id="srcline102">102</a></span><span class="line">    <span class="var type0" id="S24T0U554">ddX</span> = <span class="message error" id="M4F1C"><span class="var type1" id="S72T32U557">iMm</span> * <span class="mxinfo " id="T39:U378">[<span class="var type1" id="S15T2U560">w_0</span>;<span class="var type1" id="S16T5U562">w_m</span>]</span></span>- <span class="var type0" id="S72T0U565">iMm</span> * <span class="var type0" id="S55T0U566">C</span> * [<span class="var type0" id="S13T0U569">u0</span>;<span class="var type0" id="S14T0U571">um</span>];</span></span>
<span class="srcline"><span class="lineno"><a href="1,103" id="srcline103">103</a></span><span class="line">    <span class="var type0" id="S3T0U574">u0dot</span> = <span class="var type0" id="S24T0U576"><span class="message error" id="M5F1C">ddX</span></span>(1:<span class="var type0" id="S21T0U579">dim_0</span>,1);</span></span>
<span class="srcline"><span class="lineno"><a href="1,104" id="srcline104">104</a></span><span class="line">    <span class="var type0" id="S2T0U583">umdot</span>= <span class="var type0" id="S24T0U585"><span class="message error" id="M6F1C">ddX</span></span>(<span class="var type0" id="S21T0U588">dim_0</span>+1:<span class="var type0" id="S21T0U591">dim_0</span>+<span class="var type0" id="S22T0U592">dim_m</span>,1);</span></span>
<span class="srcline"><span class="lineno"><a href="1,105" id="srcline105">105</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,106" id="srcline106">106</a></span><span class="line">    <span class="mxinfo " id="T2:U381"><span class="var type1" id="S4T2U596">moment_system</span> = <span class="mxinfo " id="T2:U383"><span class="mxinfo " id="T2:U384"><span class="var type1" id="S45T27U599">H0</span>*<span class="var type1" id="S13T2U600">u0</span></span>+<span class="mxinfo " id="T2:U387"><span class="var type1" id="S46T29U602">H0m</span>*<span class="var type1" id="S14T1U603">um</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,107" id="srcline107">107</a></span><span class="line">    <span class="mxinfo " id="T27:U390"><span class="var type1" id="S68T27U606">B_tEE</span> = <span class="mxinfo " id="T27:U392"><span class="var type1" id="S31T25U608">Bij</span>(<span class="mxinfo " id="T35:U394">:</span>,<span class="mxinfo " id="T35:U395">:</span>,<span class="mxinfo " id="T37:U396"><span class="var type1" id="S20T19U612">target_sim</span>.id_target</span>,<span class="mxinfo " id="T37:U398"><span class="var type1" id="S20T19U615">target_sim</span>.id_EE</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,108" id="srcline108">108</a></span><span class="line">    <span class="mxinfo " id="T2:U400"><span class="var type1" id="S9T2U619">Fe</span> = <span class="mxinfo " id="T2:U402"><span class="mxinfo " id="T27:U403">-<span class="mxinfo " id="T27:U404"><span class="mxinfo " id="T27:U405">inv(<span class="var type1" id="S68T27U625">B_tEE</span>)</span>'</span></span>*(<span class="mxinfo " id="T2:U407"><span class="var type1" id="S58T27U628">C0_t</span>*<span class="var type1" id="S5T2U629">u_t</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,109" id="srcline109">109</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,110" id="srcline110">110</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,111" id="srcline111">111</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,112" id="srcline112">112</a></span><span class="line"><span class="keyword"><span class="keyword">end</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,113" id="srcline113">113</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,114" id="srcline114">114</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,115" id="srcline115">115</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,116" id="srcline116">116</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,117" id="srcline117">117</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,118" id="srcline118">118</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,119" id="srcline119">119</a></span><span class="line"></span></span>
</pre>
</body>
</html>
