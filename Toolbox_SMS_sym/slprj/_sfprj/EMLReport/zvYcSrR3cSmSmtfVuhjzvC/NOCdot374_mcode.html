<!-- saved from url=(0014)about:internet -->
<html>
<body>
<script src="resources/eml_report_loadable_data.js"></script>
<pre class="code">
<span class="srcline"><span class="lineno"><a href="123,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T107U3">Ndot</span>] = NOCdot(<span class="var type1" id="S3T3U6">r0</span>,<span class="var type1" id="S4T2U7">t0</span>,<span class="var type1" id="S5T24U8">rL</span>,<span class="var type1" id="S6T28U9">tL</span>,<span class="var type1" id="S7T27U10">P0</span>,<span class="var type1" id="S8T28U11">pm</span>,<span class="var type2" id="S9T104V6U12">robot</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="123,2" id="srcline2"> 2</a></span><span class="line"><span class="comment">% Computes the Natural Orthogonal Complement (NOC) matrix time-derivative.</span></span></span>
<span class="srcline"><span class="lineno"><a href="123,3" id="srcline3"> 3</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="123,4" id="srcline4"> 4</a></span><span class="line"><span class="comment">% [Ndot] = NOCdot(r0,t0,rL,tL,P0,pm,robot)</span></span></span>
<span class="srcline"><span class="lineno"><a href="123,5" id="srcline5"> 5</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="123,6" id="srcline6"> 6</a></span><span class="line"><span class="comment">% :parameters: </span></span></span>
<span class="srcline"><span class="lineno"><a href="123,7" id="srcline7"> 7</a></span><span class="line"><span class="comment">%   * r0 -- Position of the base-link center-of-mass with respect to the origin of the inertial frame, projected in the inertial CCS -- [3x1].</span></span></span>
<span class="srcline"><span class="lineno"><a href="123,8" id="srcline8"> 8</a></span><span class="line"><span class="comment">%   * t0 -- Base-link twist [\omega,rdot], projected in the inertial CCS -- as a [6x1] matrix.</span></span></span>
<span class="srcline"><span class="lineno"><a href="123,9" id="srcline9"> 9</a></span><span class="line"><span class="comment">%   * rL -- Positions of the links, projected in the inertial CCS -- as a [3xn] matrix.</span></span></span>
<span class="srcline"><span class="lineno"><a href="123,10" id="srcline10">10</a></span><span class="line"><span class="comment">%   * tL -- Manipulator twist [\omega,rdot], projected in the inertial CCS -- as a [6xn] matrix.</span></span></span>
<span class="srcline"><span class="lineno"><a href="123,11" id="srcline11">11</a></span><span class="line"><span class="comment">%   * P0 -- Base-link twist-propagation "vector" -- as a [6x6] matrix.</span></span></span>
<span class="srcline"><span class="lineno"><a href="123,12" id="srcline12">12</a></span><span class="line"><span class="comment">%   * pm -- Manipulator twist-propagation "vector" -- as a [6xn] matrix.</span></span></span>
<span class="srcline"><span class="lineno"><a href="123,13" id="srcline13">13</a></span><span class="line"><span class="comment">%   * robot -- Robot model (see :doc:`/Tutorial_Robot`).</span></span></span>
<span class="srcline"><span class="lineno"><a href="123,14" id="srcline14">14</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="123,15" id="srcline15">15</a></span><span class="line"><span class="comment">% :return: </span></span></span>
<span class="srcline"><span class="lineno"><a href="123,16" id="srcline16">16</a></span><span class="line"><span class="comment">%   * Ndot -- Natural Orthogonal Complement (NOC) matrix time-derivative -- as a [(6+6*n)x(6+n_q)] matrix.</span></span></span>
<span class="srcline"><span class="lineno"><a href="123,17" id="srcline17">17</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="123,18" id="srcline18">18</a></span><span class="line"><span class="comment">% Examples:</span></span></span>
<span class="srcline"><span class="lineno"><a href="123,19" id="srcline19">19</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="123,20" id="srcline20">20</a></span><span class="line"><span class="comment">%   To compute the operational-space accelerations of all links:</span></span></span>
<span class="srcline"><span class="lineno"><a href="123,21" id="srcline21">21</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="123,22" id="srcline22">22</a></span><span class="line"><span class="comment">% .. code-block:: matlab</span></span></span>
<span class="srcline"><span class="lineno"><a href="123,23" id="srcline23">23</a></span><span class="line"><span class="comment">%	</span></span></span>
<span class="srcline"><span class="lineno"><a href="123,24" id="srcline24">24</a></span><span class="line"><span class="comment">%   %Compute NOC</span></span></span>
<span class="srcline"><span class="lineno"><a href="123,25" id="srcline25">25</a></span><span class="line"><span class="comment">%   [N] = NOC(r0,rL,P0,pm,robot)</span></span></span>
<span class="srcline"><span class="lineno"><a href="123,26" id="srcline26">26</a></span><span class="line"><span class="comment">%   %Compute NOC time-derivative</span></span></span>
<span class="srcline"><span class="lineno"><a href="123,27" id="srcline27">27</a></span><span class="line"><span class="comment">%   [Ndot] = NOCdot(r0,t0,rL,tL,P0,pm,robot)</span></span></span>
<span class="srcline"><span class="lineno"><a href="123,28" id="srcline28">28</a></span><span class="line"><span class="comment">%   %Twist time-derivatives of all the links</span></span></span>
<span class="srcline"><span class="lineno"><a href="123,29" id="srcline29">29</a></span><span class="line"><span class="comment">%   tdot=N*[u0dot;umdot]+Ndot*[u0;um];</span></span></span>
<span class="srcline"><span class="lineno"><a href="123,30" id="srcline30">30</a></span><span class="line"><span class="comment">%   %Twist time-derivative of the base-link</span></span></span>
<span class="srcline"><span class="lineno"><a href="123,31" id="srcline31">31</a></span><span class="line"><span class="comment">%   t0dot=tdot(1:6,1);</span></span></span>
<span class="srcline"><span class="lineno"><a href="123,32" id="srcline32">32</a></span><span class="line"><span class="comment">%   %Twist time-derivative of the ith link</span></span></span>
<span class="srcline"><span class="lineno"><a href="123,33" id="srcline33">33</a></span><span class="line"><span class="comment">%   i=2;</span></span></span>
<span class="srcline"><span class="lineno"><a href="123,34" id="srcline34">34</a></span><span class="line"><span class="comment">%   tidot=tdot(6*i:6+6*i,1);</span></span></span>
<span class="srcline"><span class="lineno"><a href="123,35" id="srcline35">35</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="123,36" id="srcline36">36</a></span><span class="line"><span class="comment">% See also: :func:`src.kinematics_dynamics.Jacobdot` and :func:`src.kinematics_dynamics.NOC`. </span></span></span>
<span class="srcline"><span class="lineno"><a href="123,37" id="srcline37">37</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="123,38" id="srcline38">38</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="123,39" id="srcline39">39</a></span><span class="line"><span class="comment"><span class="comment">%{  </span></span></span></span>
<span class="srcline"><span class="lineno"><a href="123,40" id="srcline40">40</a></span><span class="line"><span class="comment">    LICENSE</span></span></span>
<span class="srcline"><span class="lineno"><a href="123,41" id="srcline41">41</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="123,42" id="srcline42">42</a></span><span class="line"><span class="comment">    This program is free software: you can redistribute it and/or modify</span></span></span>
<span class="srcline"><span class="lineno"><a href="123,43" id="srcline43">43</a></span><span class="line"><span class="comment">    it under the terms of the GNU Lesser General Public License as published by</span></span></span>
<span class="srcline"><span class="lineno"><a href="123,44" id="srcline44">44</a></span><span class="line"><span class="comment">    the Free Software Foundation, either version 3 of the License, or</span></span></span>
<span class="srcline"><span class="lineno"><a href="123,45" id="srcline45">45</a></span><span class="line"><span class="comment">    (at your option) any later version.</span></span></span>
<span class="srcline"><span class="lineno"><a href="123,46" id="srcline46">46</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="123,47" id="srcline47">47</a></span><span class="line"><span class="comment">    This program is distributed in the hope that it will be useful,</span></span></span>
<span class="srcline"><span class="lineno"><a href="123,48" id="srcline48">48</a></span><span class="line"><span class="comment">    but WITHOUT ANY WARRANTY; without even the implied warranty of</span></span></span>
<span class="srcline"><span class="lineno"><a href="123,49" id="srcline49">49</a></span><span class="line"><span class="comment">    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></span></span>
<span class="srcline"><span class="lineno"><a href="123,50" id="srcline50">50</a></span><span class="line"><span class="comment">    GNU Lesser General Public License for more details.</span></span></span>
<span class="srcline"><span class="lineno"><a href="123,51" id="srcline51">51</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="123,52" id="srcline52">52</a></span><span class="line"><span class="comment">    You should have received a copy of the GNU Lesser General Public License</span></span></span>
<span class="srcline"><span class="lineno"><a href="123,53" id="srcline53">53</a></span><span class="line"><span class="comment">    along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></span></span>
<span class="srcline"><span class="lineno"><a href="123,54" id="srcline54">54</a></span><span class="line"><span class="comment"><span class="comment">%}</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="123,55" id="srcline55">55</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="123,56" id="srcline56">56</a></span><span class="line"><span class="comment">%=== Code ===%</span></span></span>
<span class="srcline"><span class="lineno"><a href="123,57" id="srcline57">57</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="123,58" id="srcline58">58</a></span><span class="line"><span class="comment">%Pre-allocate NOCdot</span></span></span>
<span class="srcline"><span class="lineno"><a href="123,59" id="srcline59">59</a></span><span class="line"><span class="mxinfo " id="T107:U9"><span class="var type1" id="S2T107U15">Ndot</span>=<span class="mxinfo " id="T107:U11">zeros(<span class="mxinfo " id="T5:U12">6+6*<span class="var type1" id="S9T104U23">robot</span>.n_links_joints</span>,<span class="mxinfo " id="T5:U14">6+<span class="var type1" id="S9T104U28">robot</span>.n_q</span>,<span class="string">'like'</span>,<span class="var type1" id="S3T3U31">r0</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="123,60" id="srcline60">60</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="123,61" id="srcline61">61</a></span><span class="line"><span class="comment">%Compute the NOC time derivative matrix by using the Jacobians time derivative</span></span></span>
<span class="srcline"><span class="lineno"><a href="123,62" id="srcline62">62</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="123,63" id="srcline63">63</a></span><span class="line"><span class="comment">%Base-link contribution</span></span></span>
<span class="srcline"><span class="lineno"><a href="123,64" id="srcline64">64</a></span><span class="line"><span class="mxinfo " id="T27:U17"><span class="var type1" id="S11T27U34">Omega0</span>=<span class="mxinfo " id="T27:U19">[<span class="mxinfo " id="T63:U20"><span class="mxinfo " id="T4:U21"><span class="fcn" id="F58N18:B38">SkewSym</span>(<span class="mxinfo " id="T3:U22"><span class="var type1" id="S4T2U40">t0</span>(<span class="mxinfo " id="T71:U24">1:3</span>)</span>)</span>, <span class="mxinfo " id="T4:U25">zeros(<span class="mxinfo " id="T5:U26">3</span>,<span class="mxinfo " id="T5:U27">3</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="123,65" id="srcline65">65</a></span><span class="line">    <span class="mxinfo " id="T63:U28">zeros(<span class="mxinfo " id="T5:U29">3</span>,<span class="mxinfo " id="T5:U30">3</span>), zeros(<span class="mxinfo " id="T5:U31">3</span>,<span class="mxinfo " id="T5:U32">3</span>)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="123,66" id="srcline66">66</a></span><span class="line"><span class="mxinfo " id="T33:U33"><span class="mxinfo " id="T33:U34"><span class="var type1" id="S2T107U60">Ndot</span>(<span class="mxinfo " id="T62:U36"><span class="mxinfo " id="T5:U37">1</span>:<span class="mxinfo " id="T5:U38">6</span></span>,<span class="mxinfo " id="T88:U39"><span class="mxinfo " id="T5:U40">1</span>:<span class="mxinfo " id="T5:U41">6+<span class="var type1" id="S9T104U69">robot</span>.n_q</span></span>)</span>=<span class="mxinfo " id="T33:U43">[<span class="mxinfo " id="T27:U44"><span class="var type1" id="S11T27U74">Omega0</span>*<span class="var type1" id="S7T27U75">P0</span></span>,<span class="mxinfo " id="T29:U47">zeros(<span class="mxinfo " id="T5:U48">6</span>,<span class="mxinfo " id="T5:U49"><span class="var type1" id="S9T104U80">robot</span>.n_q</span>)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="123,67" id="srcline67">67</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="123,68" id="srcline68">68</a></span><span class="line"><span class="comment">%Manipulator contribution</span></span></span>
<span class="srcline"><span class="lineno"><a href="123,69" id="srcline69">69</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S13T5U84">i</span>=<span class="mxinfo " id="T16:U52"><span class="mxinfo " id="T5:U53">1</span>:<span class="var type1" id="S9T104U88">robot</span>.n_links_joints</span></span></span>
<span class="srcline"><span class="lineno"><a href="123,70" id="srcline70">70</a></span><span class="line">    [<span class="var type1" id="S14T27U93">J0doti</span>, <span class="var type1" id="S15T29U94">Jmdoti</span>]=<span class="fcn" id="F375N13:B96">Jacobdot</span>(<span class="mxinfo " id="T3:U57"><span class="var type1" id="S5T24U98">rL</span>(<span class="mxinfo " id="T36:U59">1:3</span>,<span class="var type1" id="S13T5U102">i</span>)</span>,<span class="mxinfo " id="T2:U61"><span class="var type1" id="S6T28U104">tL</span>(<span class="mxinfo " id="T35:U63">1:6</span>,<span class="var type1" id="S13T5U108">i</span>)</span>,<span class="var type1" id="S3T3U109">r0</span>,<span class="var type1" id="S4T2U110">t0</span>,<span class="var type1" id="S5T24U111">rL</span>,<span class="var type1" id="S6T28U112">tL</span>,<span class="var type1" id="S7T27U113">P0</span>,<span class="var type1" id="S8T28U114">pm</span>,<span class="var type1" id="S13T5U115">i</span>,<span class="var type1" id="S9T104U116">robot</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="123,71" id="srcline71">71</a></span><span class="line">    <span class="mxinfo " id="T110:U73"><span class="mxinfo " id="T110:U74"><span class="var type1" id="S2T107U120">Ndot</span>(<span class="mxinfo " id="T64:U76"><span class="mxinfo " id="T5:U77"><span class="mxinfo " id="T5:U78"><span class="mxinfo " id="T5:U79">6</span>+<span class="mxinfo " id="T5:U80"><span class="mxinfo " id="T5:U81">6</span>*<span class="var type1" id="S13T5U127">i</span></span></span>-<span class="mxinfo " id="T5:U83">5</span></span>:<span class="mxinfo " id="T5:U84"><span class="mxinfo " id="T5:U85">6</span>+<span class="mxinfo " id="T5:U86"><span class="mxinfo " id="T5:U87">6</span>*<span class="var type1" id="S13T5U133">i</span></span></span></span>,<span class="mxinfo " id="T103:U89">1:6+<span class="var type1" id="S9T104U139">robot</span>.n_q</span>)</span>=<span class="mxinfo " id="T33:U91">[<span class="var type1" id="S14T27U143">J0doti</span>,<span class="var type1" id="S15T29U144">Jmdoti</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="123,72" id="srcline72">72</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="123,73" id="srcline73">73</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="123,74" id="srcline74">74</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="123,75" id="srcline75">75</a></span><span class="line"><span class="keyword">end</span></span></span>
</pre>
</body>
</html>
